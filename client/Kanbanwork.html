<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sofany Pro CRM - –ö–∞–Ω–±–∞–Ω</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
    :root {
        --primary: #0ea5a5;
        --primary-dark: #0b8f8f;
        --primary-light: #e0f7f7;
        --success: #10b981;
        --success-light: #d1fae5;
        --warning: #f59e0b;
        --warning-light: #fef3c7;
        --error: #ef4444;
        --error-light: #fee2e2;
        --text: #0f172a;
        --text-muted: #64748b;
        --bg: #f8fafc;
        --card-bg: #ffffff;
        --border: #e2e8f0;
        --border-light: #f1f5f9;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-hover: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        --golden-ratio: 61.8%;
    }

    .dark-theme {
        --primary: #0ea5a5;
        --primary-dark: #0b8f8f;
        --primary-light: #1a3e3e;
        --text: #e2e8f0;
        --text-muted: #94a3b8;
        --bg: #0f172a;
        --card-bg: #1e293b;
        --border: #334155;
        --border-light: #1e293b;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
        --shadow-hover: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.3);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Inter', sans-serif;
    }

    body {
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
        padding: 1.5rem;
        position: relative;
        overflow-x: hidden;
        transition: background 0.3s, color 0.3s;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
    }

    .logo {
        font-size: 1.8rem;
        font-weight: 800;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .theme-toggle {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 2rem;
        padding: 0.5rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s;
    }

    .theme-toggle:hover {
        box-shadow: var(--shadow);
    }

    .theme-icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* –ö–∞–Ω–±–∞–Ω –¥–æ—Å–∫–∞ */
    .kanban-board {
        display: flex;
        gap: 1.5rem;
        padding-bottom: 1rem;
        overflow-x: hidden;
        transition: overflow-x 0.3s;
    }

    .kanban-board:hover {
        overflow-x: auto;
    }

    .kanban-column {
        min-width: 320px;
        background: var(--card-bg);
        border-radius: 0.75rem;
        padding: 1.25rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-light);
    }

    .column-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1.25rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid var(--border);
    }

    .column-title {
        font-size: 1.125rem;
        font-weight: 600;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        padding: 0.5rem;
        border-radius: 0.375rem;
        transition: all 0.2s;
    }

    .column-title:hover {
        background: var(--bg);
    }

    .column-sum {
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--primary);
        background: var(--primary-light);
        padding: 0.25rem 0.5rem;
        border-radius: 0.5rem;
        display: inline-block;
        width: fit-content;
    }

    .column-title-input {
        font-size: 1.125rem;
        font-weight: 600;
        border: 1px solid var(--primary);
        border-radius: 0.375rem;
        padding: 0.5rem;
        width: 100%;
    }

    .column-count {
        background: var(--primary-light);
        color: var(--primary);
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.25rem 0.5rem;
        border-radius: 1rem;
    }

    .column-actions {
        display: flex;
        gap: 0.5rem;
    }

    .column-action {
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
        padding: 0.25rem;
        border-radius: 0.25rem;
    }

    .column-action:hover {
        color: var(--primary);
        background: var(--primary-light);
    }

    .column-delete {
        color: var(--error) !important;
    }

    .column-delete:hover {
        color: white !important;
        background: var(--error) !important;
        transform: scale(1.05);
    }

    /* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ */
    .kanban-column[data-column-id="1"] .column-delete,
    .kanban-column[data-column-id="2"] .column-delete,
    .kanban-column[data-column-id="3"] .column-delete,
    .kanban-column[data-column-id="4"] .column-delete,
    .kanban-column[data-column-id="5"] .column-delete,
    .kanban-column[data-column-id="6"] .column-delete,
    .kanban-column[data-column-id="7"] .column-delete {
        display: none;
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
    .kanban-cards {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        min-height: 100px;
    }

    .kanban-card {
        background: var(--card-bg);
        border-radius: 0.5rem;
        padding: 1.25rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-light);
        cursor: pointer;
        transition: all 0.2s;
    }

    .kanban-card:hover {
        box-shadow: var(--shadow-hover);
        transform: translateY(-2px);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.75rem;
    }

    .card-amount {
        background: var(--success);
        color: white;
        font-size: 0.875rem;
        font-weight: 600;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
    }

    .card-priority {
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-weight: 600;
    }

    .priority-high {
        background: var(--error-light);
        color: var(--error);
    }

    .priority-medium {
        background: var(--warning-light);
        color: var(--warning);
    }

    .priority-low {
        background: var(--success-light);
        color: var(--success);
    }

    .card-title {
        font-weight: 600;
        margin-bottom: 1rem;
        line-height: 1.4;
        font-size: 1.1rem;
    }

    .card-dates {
        display: flex;
        justify-content: space-between;
        color: var(--text-muted);
        font-size: 0.875rem;
        margin-bottom: 1rem;
    }

    .prepayment {
        font-weight: 600;
        color: var(--success);
    }

    .card-footer {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –≤–µ—Ç–æ–∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ */
    .card-branches {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.75rem;
        padding: 0.5rem;
        background: var(--bg);
        border-radius: 0.5rem;
        border: 1px solid var(--border-light);
    }

    .branch-item {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.75rem;
        font-weight: 500;
    }

    .branch-icon {
        width: 1rem;
        height: 1rem;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.625rem;
    }

    .branch-frame {
        background: #fef3c7;
        color: #92400e;
    }

    .branch-upholstery {
        background: #f3e8ff;
        color: #7c3aed;
    }

    .branch-status {
        font-size: 0.625rem;
        padding: 0.125rem 0.375rem;
        border-radius: 0.25rem;
        font-weight: 600;
    }

    .status-not-started {
        background: #f3f4f6;
        color: #6b7280;
    }

    .status-in-progress {
        background: #dbeafe;
        color: #1d4ed8;
    }

    .status-completed {
        background: #d1fae5;
        color: #065f46;
    }

    .branch-label {
        font-size: 0.625rem;
        color: var(--text-muted);
        margin-right: 0.25rem;
    }

    .client-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: var(--primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
        font-weight: 600;
        flex-shrink: 0;
    }

    .client-name {
        font-weight: 500;
        font-size: 0.9rem;
    }

    /* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ */
    .add-card-form {
        margin-top: 1rem;
        padding: 1rem;
        border-radius: 0.5rem;
        background: var(--bg);
        border: 1px dashed var(--border);
    }

    .form-group {
        margin-bottom: 0.75rem;
    }

    .form-input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        font-size: 1rem;
        background: var(--card-bg);
        color: var(--text);
    }

    .form-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px var(--primary-light);
    }

    .form-actions {
        display: flex;
        gap: 0.5rem;
        justify-content: flex-end;
    }

    /* –ö–Ω–æ–ø–∫–∏ */
    .btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 0.375rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-primary {
        background-color: var(--primary);
        color: white;
    }

    .btn-primary:hover {
        background-color: var(--primary-dark);
    }

    .btn-secondary {
        background-color: var(--bg);
        color: var(--text);
        border: 1px solid var(--border);
    }

    .btn-secondary:hover {
        background-color: var(--border);
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è */
    .kanban-card.dragging {
        opacity: 0.5;
        transform: rotate(5deg);
    }

    .kanban-column.drop-area {
        background-color: var(--primary-light);
        border: 2px dashed var(--primary);
    }

    /* –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å */
    .detail-panel {
        position: fixed;
        top: 0;
        right: 0;
        width: 61.8%; /* –ó–æ–ª–æ—Ç–æ–µ —Å–µ—á–µ–Ω–∏–µ */
        max-width: 650px;
        min-width: 450px;
        height: 100vh;
        background: var(--card-bg);
        box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 1.5rem;
        transform: translateX(100%);
        opacity: 0;
        visibility: hidden;
        transition: transform 0.3s ease, opacity 0.3s ease, visibility 0.3s;
        border-radius: 0.75rem 0 0 0.75rem; /* –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å –ª–µ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã */
        box-sizing: border-box;
        contain: layout style;
    }

    .detail-panel.active {
        transform: translateX(0);
        opacity: 1;
        visibility: visible;
    }

    .panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--border);
    }

    .panel-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text);
    }

    .panel-actions {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .close-panel, .add-column-btn {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text-muted);
        transition: all 0.2s;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
    }

    .close-panel:hover, .add-column-btn:hover {
        color: var(--error);
        background: var(--error-light);
    }

    .client-info {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .client-details h3 {
        font-size: 1.25rem;
        margin-bottom: 0.25rem;
    }

    .client-details p {
        color: var(--text-muted);
    }

    .order-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .detail-item {
        padding: 1rem;
        background: var(--bg);
        border-radius: 0.5rem;
    }

    .detail-item label {
        display: block;
        font-size: 0.875rem;
        color: var(--text-muted);
        margin-bottom: 0.5rem;
    }

    .detail-item .value {
        font-weight: 600;
        font-size: 1rem;
    }

    .select-status {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        background: var(--card-bg);
        font-weight: 500;
        color: var(--text);
    }

    .panel-tabs {
        display: flex;
        border-bottom: 1px solid var(--border);
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
        position: relative;
        z-index: 2;
        background: var(--card-bg);
    }

    .tab {
        padding: 0.75rem 1.5rem;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.2s;
        font-weight: 500;
    }

    .tab.active {
        color: var(--primary);
        border-bottom-color: var(--primary);
    }

    .tab-content {
        display: none;
        position: relative;
        z-index: 1;
    }

    .tab-content.active {
        display: block;
        position: relative;
        z-index: 1;
    }

    /* –°–µ–∫—Ü–∏–∏ –≤ —Ç–∞–±–∞—Ö */
    .project-description-section,
    .drawings-section,
    .comments-section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: var(--bg);
        border-radius: 0.75rem;
        border: 1px solid var(--border-light);
    }

    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid var(--border);
    }

    .section-header h3 {
        margin: 0;
        color: var(--text);
        font-size: 1.125rem;
        font-weight: 600;
    }

    .edit-btn,
    .add-file-btn,
    .add-comment-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s ease;
    }

    .edit-btn:hover,
    .add-file-btn:hover,
    .add-comment-btn:hover {
        background: var(--primary-dark);
        transform: translateY(-1px);
    }

    /* –ü–æ–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ */
    .description-field {
        margin-bottom: 1.5rem;
    }

    .description-field label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: var(--text);
        font-size: 0.875rem;
    }

    .field-content {
        position: relative;
    }

    .field-value {
        display: block;
        padding: 0.75rem;
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        color: var(--text);
        min-height: 2.5rem;
        line-height: 1.5;
    }

    .field-input,
    .field-textarea {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--primary);
        border-radius: 0.5rem;
        background: var(--card-bg);
        color: var(--text);
        font-family: inherit;
        font-size: 0.875rem;
        resize: vertical;
    }

    .field-textarea {
        min-height: 4rem;
    }

    .description-actions {
        display: flex;
        gap: 0.75rem;
        justify-content: flex-end;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border);
    }

    /* –§–∞–π–ª—ã */
    .files-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .file-download {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem;
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        transition: all 0.2s ease;
    }

    .file-download:hover {
        border-color: var(--primary);
        box-shadow: 0 2px 8px rgba(14, 165, 165, 0.1);
    }

    .file-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex: 1;
    }

    .file-icon {
        color: var(--primary);
        flex-shrink: 0;
    }

    .file-name {
        font-weight: 500;
        color: var(--text);
        margin-bottom: 0.25rem;
    }

    .file-size {
        font-size: 0.75rem;
        color: var(--text-muted);
    }

    .file-actions {
        display: flex;
        gap: 0.5rem;
        align-items: center;
    }

    .download-btn {
        padding: 0.5rem 1rem;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        font-size: 0.75rem;
        font-weight: 500;
        transition: all 0.2s ease;
    }

    .download-btn:hover {
        background: var(--primary-dark);
    }

    .delete-btn {
        width: 2rem;
        height: 2rem;
        background: var(--error);
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1rem;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .delete-btn:hover {
        background: #dc2626;
        transform: scale(1.1);
    }

    .comment {
        padding: 1rem;
        background: var(--card-bg);
        border-radius: 0.5rem;
        margin-bottom: 1rem;
        border: 1px solid var(--border-light);
    }

    /* –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –±–ª–æ–∫ */
    .finance-section,
    .payments-history-section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: var(--bg);
        border-radius: 0.75rem;
        border: 1px solid var(--border-light);
    }

    .finance-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1.5rem;
        background: var(--card-bg);
        border-radius: 0.75rem;
        border: 1px solid var(--border);
        transition: all 0.2s ease;
    }

    .stat-card:hover {
        border-color: var(--primary);
        box-shadow: 0 4px 12px rgba(14, 165, 165, 0.1);
    }

    .stat-icon {
        color: var(--primary);
        flex-shrink: 0;
    }

    .stat-content {
        flex: 1;
    }

    .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text);
        margin-bottom: 0.25rem;
    }

    .stat-label {
        font-size: 0.875rem;
        color: var(--text-muted);
        font-weight: 500;
    }

    .finance-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .detail-field {
        display: flex;
        flex-direction: column;
    }

    .detail-field label {
        font-weight: 500;
        color: var(--text);
        margin-bottom: 0.5rem;
        font-size: 0.875rem;
    }

    .field-select {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--primary);
        border-radius: 0.5rem;
        background: var(--card-bg);
        color: var(--text);
        font-family: inherit;
        font-size: 0.875rem;
    }

    .finance-actions {
        display: flex;
        gap: 0.75rem;
        justify-content: flex-end;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border);
    }

    /* –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π */
    .payments-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .payment-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem;
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 0.5rem;
        transition: all 0.2s ease;
    }

    .payment-item:hover {
        border-color: var(--primary);
        box-shadow: 0 2px 8px rgba(14, 165, 165, 0.1);
    }

    .payment-info {
        flex: 1;
    }

    .payment-amount {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--text);
        margin-bottom: 0.25rem;
    }

    .payment-type {
        font-size: 0.875rem;
        color: var(--text-muted);
    }

    .payment-details {
        flex: 1;
        text-align: center;
    }

    .payment-date {
        font-size: 0.875rem;
        color: var(--text);
        margin-bottom: 0.25rem;
    }

    .payment-method {
        font-size: 0.75rem;
        color: var(--text-muted);
    }

    .payment-actions {
        display: flex;
        gap: 0.5rem;
        align-items: center;
    }

    .edit-payment-btn,
    .delete-payment-btn {
        width: 2rem;
        height: 2rem;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        font-size: 0.875rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }
    
    .edit-payment-btn svg,
    .delete-payment-btn svg {
        width: 14px;
        height: 14px;
    }

    .edit-payment-btn {
        background: var(--warning-light);
        color: var(--warning);
    }

    .edit-payment-btn:hover {
        background: var(--warning);
        color: white;
    }

    .delete-payment-btn {
        background: var(--error-light);
        color: var(--error);
    }

    .delete-payment-btn:hover {
        background: var(--error);
        color: white;
    }

    /* –¢–∞–±–ª–∏—Ü–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ */
    .materials-section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: var(--bg);
        border-radius: 0.75rem;
        border: 1px solid var(--border-light);
    }

    .materials-table-container {
        overflow-x: auto;
        border-radius: 0.5rem;
        border: 1px solid var(--border);
    }

    .materials-table {
        width: 100%;
        border-collapse: collapse;
        background: var(--card-bg);
    }

    .materials-table thead {
        background: var(--primary-light);
    }

    .materials-table th {
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        color: var(--text);
        border-bottom: 1px solid var(--border);
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .materials-table td {
        padding: 1rem;
        border-bottom: 1px solid var(--border-light);
        color: var(--text);
        font-size: 0.875rem;
    }

    .materials-table tbody tr:hover {
        background: var(--bg);
    }

    .materials-table tbody tr:last-child td {
        border-bottom: none;
    }

    .materials-table .actions-cell {
        width: 120px;
        text-align: center;
    }

    .edit-material-btn,
    .delete-material-btn {
        width: 2rem;
        height: 2rem;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        font-size: 0.875rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin: 0 0.25rem;
        transition: all 0.2s ease;
    }
    
    .edit-material-btn svg,
    .delete-material-btn svg {
        width: 14px;
        height: 14px;
    }

    .edit-material-btn {
        background: var(--warning-light);
        color: var(--warning);
    }

    .edit-material-btn:hover {
        background: var(--warning);
        color: white;
        transform: scale(1.05);
    }

    .delete-material-btn {
        background: var(--error-light);
        color: var(--error);
    }

    .delete-material-btn:hover {
        background: var(--error);
        color: white;
        transform: scale(1.05);
    }

    .add-material-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s ease;
    }

    .add-material-btn:hover {
        background: var(--primary-dark);
        transform: translateY(-1px);
    }

    .comment-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
    }

    .comment-author {
        font-weight: 600;
    }

    .comment-time {
        color: var(--text-muted);
        font-size: 0.875rem;
    }

    .comment-text {
        line-height: 1.5;
    }

    .file-download {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.75rem;
        background: var(--bg);
        border-radius: 0.5rem;
        margin-bottom: 0.75rem;
    }

    .file-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .file-icon {
        width: 40px;
        height: 40px;
        background: var(--primary-light);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary);
    }

    .file-name {
        font-weight: 500;
    }

    .file-size {
        font-size: 0.875rem;
        color: var(--text-muted);
    }

    .download-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        cursor: pointer;
        font-weight: 500;
        transition: background 0.2s;
    }

    .download-btn:hover {
        background: var(--primary-dark);
    }

    .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .stat-card {
        padding: 1rem;
        background: var(--bg);
        border-radius: 0.5rem;
        text-align: center;
    }

    .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 0.25rem;
    }

    .stat-label {
        font-size: 0.875rem;
        color: var(--text-muted);
    }

    .material-item {
        display: flex;
        justify-content: space-between;
        padding: 0.75rem;
        background: var(--bg);
        border-radius: 0.5rem;
        margin-bottom: 0.75rem;
    }

    .material-name {
        font-weight: 500;
    }

    .material-quantity {
        color: var(--text-muted);
    }

    .contacts-section,
    .delivery-section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: var(--bg);
        border-radius: 0.75rem;
        border: 1px solid var(--border-light);
    }
    
    .contacts-info,
    .delivery-info {
        padding: 0;
        background: transparent;
        border-radius: 0;
        margin-bottom: 0;
    }

    .info-row {
        display: flex;
        flex-direction: column;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--border-light);
    }

    .info-row:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
    }

    .info-label {
        font-weight: 500;
        margin-bottom: 0.5rem;
        color: var(--text);
        font-size: 0.875rem;
    }

    .info-value {
        color: var(--text);
        font-weight: 500;
    }
    
    .field-content {
        position: relative;
        width: 100%;
    }
    
    .field-select {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--primary);
        border-radius: 0.5rem;
        background: var(--card-bg);
        color: var(--text);
        font-family: inherit;
        font-size: 0.875rem;
    }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
    }

    .overlay.active {
        opacity: 1;
        visibility: visible;
    }

    /* –û–≤–µ—Ä–ª–µ–π –¥–ª—è –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ */
    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }

    .overlay.active {
        opacity: 1;
        visibility: visible;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 1024px) {
        .detail-panel {
            width: 75%;
            max-width: 600px;
        }
    }

    @media (max-width: 768px) {
        .kanban-column {
            min-width: 280px;
        }
        
        .header {
            flex-direction: column;
            gap: 1rem;
            align-items: flex-start;
        }
        
        .detail-panel {
            width: 100%;
            min-width: unset;
            max-width: 100%;
            transform: translateX(100%);
            border-radius: 0;
            padding: 1rem;
        }
        
        .detail-panel.active {
            transform: translateX(0);
        }

        .order-details {
            grid-template-columns: 1fr;
        }
    }
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <div class="header">
            <div class="logo">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
            Sofany Pro CRM
            </div>

        <button class="theme-toggle" id="theme-toggle">
            <div class="theme-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </div>
            <span>–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
        </button>
        
        <button class="btn btn-outline" onclick="loadKanbanData()" style="margin-left: 1rem;">
            üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
        </button>
    </div>

    <!-- –ö–∞–Ω–±–∞–Ω –¥–æ—Å–∫–∞ -->
    <div class="kanban-board" id="kanban-board">
        <!-- –ö–æ–ª–æ–Ω–∫–∞ 1 -->
        <div class="kanban-column" data-column-id="1">
            <div class="column-header">
                <div class="column-title">
                    <span>–ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã</span>
                    <span class="column-sum" id="column-sum-1">106 400 ‚ÇΩ</span>
                    <span class="column-count">3</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="kanban-cards">
                <div class="kanban-card" draggable="true" data-card-id="1" data-card-amount="42500" onclick="openDetailPanel(this)">
                    <div class="card-header">
                        <div class="card-amount">42 500 ‚ÇΩ</div>
                        <div class="card-priority priority-high">–í—ã—Å–æ–∫–∏–π</div>
                    </div>
                    <h3 class="card-title">–î–∏–≤–∞–Ω "–ù–µ–∞–ø–æ–ª—å" —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω</h3>
                    <div class="card-dates">
                        <span>–°–æ–∑–¥–∞–Ω: 10.09.2023</span>
                        <span class="prepayment">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: 15 000 ‚ÇΩ</span>
                    </div>
                    
                    <!-- –í–µ—Ç–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ -->
                    <div class="card-branches">
                        <div class="branch-item">
                            <div class="branch-icon branch-frame">üî®</div>
                            <span class="branch-label">–ö–∞—Ä–∫–∞—Å:</span>
                            <span class="branch-status status-not-started">–ù–µ –Ω–∞—á–∞—Ç</span>
                        </div>
                        <div class="branch-item">
                            <div class="branch-icon branch-upholstery">üßµ</div>
                            <span class="branch-label">–û–±–∏–≤–∫–∞:</span>
                            <span class="branch-status status-not-started">–ù–µ –Ω–∞—á–∞—Ç</span>
                        </div>
                    </div>
                    
                    <div class="card-footer">
                        <div class="client-avatar">–ê–ß</div>
                        <div class="client-name">–ê–ª–µ–∫—Å–µ–π –ß–µ—Ä–Ω–æ–≤</div>
                    </div>
                </div>

                <div class="kanban-card" draggable="true" data-card-id="2" data-card-amount="28700" onclick="openDetailPanel(this)">
                    <div class="card-header">
                        <div class="card-amount">28 700 ‚ÇΩ</div>
                        <div class="card-priority priority-medium">–°—Ä–µ–¥–Ω–∏–π</div>
                    </div>
                    <h3 class="card-title">–ö—Ä–µ—Å–ª–æ "–ú–µ–ª–∏—Å—Å–∞" —Å –ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫–æ–º</h3>
                    <div class="card-dates">
                        <span>–°–æ–∑–¥–∞–Ω: 12.09.2023</span>
                        <span class="prepayment">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: 10 000 ‚ÇΩ</span>
                    </div>
                    <div class="card-footer">
                        <div class="client-avatar">–ú–ü</div>
                        <div class="client-name">–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞</div>
                    </div>
                </div>

                <div class="kanban-card" draggable="true" data-card-id="3" data-card-amount="35200" onclick="openDetailPanel(this)">
                    <div class="card-header">
                        <div class="card-amount">35 200 ‚ÇΩ</div>
                        <div class="card-priority priority-low">–ù–∏–∑–∫–∏–π</div>
                    </div>
                    <h3 class="card-title">–°—Ç–µ–Ω–∫–∞ "–ú–æ–¥–µ—Ä–Ω" —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π</h3>
                    <div class="card-dates">
                        <span>–°–æ–∑–¥–∞–Ω: 14.09.2023</span>
                        <span class="prepayment">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: 12 000 ‚ÇΩ</span>
                    </div>
                    <div class="card-footer">
                        <div class="client-avatar">–î–ö</div>
                        <div class="client-name">–î–º–∏—Ç—Ä–∏–π –ö–æ–∑–ª–æ–≤</div>
                    </div>
                </div>
            </div>

            <div class="add-card-form" style="display: none;">
                        <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                        </div>
                        <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                        </div>
                        <div class="form-group">
                    <input type="number" class="form-input" placeholder="–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞">
                        </div>
                        <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                        </div>
                        <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                        </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                    </div>
                </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 2 -->
        <div class="kanban-column" data-column-id="2">
            <div class="column-header">
                <div class="column-title">
                    <span>–í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ</span>
                    <span class="column-sum" id="column-sum-2">75 100 ‚ÇΩ</span>
                    <span class="column-count">2</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="kanban-cards">
                <div class="kanban-card" draggable="true" data-card-id="4" data-card-amount="51300" onclick="openDetailPanel(this)">
                    <div class="card-header">
                        <div class="card-amount">51 300 ‚ÇΩ</div>
                        <div class="card-priority priority-high">–í—ã—Å–æ–∫–∏–π</div>
                    </div>
                    <h3 class="card-title">–ì–æ—Å—Ç–∏–Ω–∞—è "–ú–∏–ª–∞–Ω" —Å –∫–æ–∂–∞–Ω–æ–π –æ—Ç–¥–µ–ª–∫–æ–π</h3>
                    <div class="card-dates">
                        <span>–°–æ–∑–¥–∞–Ω: 05.09.2023</span>
                        <span class="prepayment">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: 20 000 ‚ÇΩ</span>
                    </div>
                    <div class="card-footer">
                        <div class="client-avatar">–û–°</div>
                        <div class="client-name">–û–ª—å–≥–∞ –°–µ–º–µ–Ω–æ–≤–∞</div>
                    </div>
                </div>

                <div class="kanban-card" draggable="true" data-card-id="5" data-card-amount="23800" onclick="openDetailPanel(this)">
                    <div class="card-header">
                        <div class="card-amount">23 800 ‚ÇΩ</div>
                        <div class="card-priority priority-medium">–°—Ä–µ–¥–Ω–∏–π</div>
                    </div>
                    <h3 class="card-title">–°—Ç–æ–ª –∂—É—Ä–Ω–∞–ª—å–Ω—ã–π "–§—å—é–∂–Ω" —Å–æ —Å—Ç–µ–∫–ª–æ–º</h3>
                    <div class="card-dates">
                        <span>–°–æ–∑–¥–∞–Ω: 08.09.2023</span>
                        <span class="prepayment">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: 8 000 ‚ÇΩ</span>
                    </div>
                    <div class="card-footer">
                        <div class="client-avatar">–ò–í</div>
                        <div class="client-name">–ò–≥–æ—Ä—å –í–∞—Å–∏–ª—å–µ–≤</div>
                    </div>
                </div>
            </div>

            <div class="add-card-form" style="display: none;">
                        <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                        </div>
                        <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                        </div>
                        <div class="form-group">
                    <input type="number" class="form-input" placeholder="–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞">
                        </div>
                <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                    </div>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                        </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                    </div>
                </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 3 -->
        <div class="kanban-column" data-column-id="3">
            <div class="column-header">
                <div class="column-title">
                    <span>–§–æ—Ä–º–æ–≤–∫–∞</span>
                    <span class="column-sum" id="column-sum-3">0 ‚ÇΩ</span>
                    <span class="column-count">0</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="kanban-cards">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="add-card-form" style="display: none;">
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                </div>
                <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                </div>
                <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 4 -->
        <div class="kanban-column" data-column-id="4">
            <div class="column-header">
                <div class="column-title">
                    <span>–°—Ç–æ–ª—è—Ä–Ω—ã–π —Ü–µ—Ö</span>
                    <span class="column-sum" id="column-sum-4">0 ‚ÇΩ</span>
                    <span class="column-count">0</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="kanban-cards">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="add-card-form" style="display: none;">
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                </div>
                <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                </div>
                <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 5 -->
        <div class="kanban-column" data-column-id="5">
            <div class="column-header">
                <div class="column-title">
                    <span>–û–±–∏–≤–∫–∞</span>
                    <span class="column-sum" id="column-sum-5">0 ‚ÇΩ</span>
                    <span class="column-count">0</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="kanban-cards">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="add-card-form" style="display: none;">
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                </div>
                <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                </div>
                <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 6 -->
        <div class="kanban-column" data-column-id="6">
            <div class="column-header">
                <div class="column-title">
                    <span>–®–≤–µ–π–Ω—ã–π —Ü–µ—Ö</span>
                    <span class="column-sum" id="column-sum-6">0 ‚ÇΩ</span>
                    <span class="column-count">0</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="kanban-cards">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="add-card-form" style="display: none;">
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                </div>
                <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                </div>
                <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ö–æ–ª–æ–Ω–∫–∞ 7 -->
        <div class="kanban-column" data-column-id="7">
            <div class="column-header">
                <div class="column-title">
                    <span>–û—Ç–≥—Ä—É–∂–µ–Ω</span>
                    <span class="column-sum" id="column-sum-7">0 ‚ÇΩ</span>
                    <span class="column-count">0</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="kanban-cards">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="add-card-form" style="display: none;">
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                </div>
                <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                </div>
                <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>

    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π -->
    <div class="overlay" id="overlay" onclick="closeDetailPanel()"></div>

    <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å –¥–µ—Ç–∞–ª–µ–π -->
    <div class="detail-panel" id="detail-panel">
        <div class="panel-header">
            <h2 class="panel-title">–î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞</h2>
            <div class="panel-actions">
                <button class="add-column-btn" onclick="createNewColumn()">+</button>
                <button class="close-panel" onclick="closeDetailPanel()">&times;</button>
                        </div>
                    </div>

        <div class="client-info">
            <div class="client-avatar" id="detail-avatar">–ê–ß</div>
            <div class="client-details">
                <h3 id="detail-client-name">–ê–ª–µ–∫—Å–µ–π –ß–µ—Ä–Ω–æ–≤</h3>
                <p id="detail-product">–î–∏–≤–∞–Ω "–ù–µ–∞–ø–æ–ª—å" —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω</p>
                    </div>
                </div>

        <div class="order-details">
            <div class="detail-item">
                <label>–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞</label>
                <select class="select-status" id="detail-status">
                    <option value="new">–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</option>
                    <option value="production">–í –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ</option>
                    <option value="ready">–ì–æ—Ç–æ–≤ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ</option>
                    <option value="shipped">–û—Ç–≥—Ä—É–∂–µ–Ω</option>
                    <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
                </select>
                    </div>
            <div class="detail-item">
                <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                <div class="value" id="detail-priority">–í—ã—Å–æ–∫–∏–π</div>
                    </div>
            <div class="detail-item">
                <label>–°—É–º–º–∞ —Å–¥–µ–ª–∫–∏</label>
                <div class="value" id="detail-amount">42 500 ‚ÇΩ</div>
            </div>
            <div class="detail-item">
                <label>–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞</label>
                <div class="value" id="detail-prepayment">15 000 ‚ÇΩ</div>
            </div>
        </div>

        <div class="panel-tabs">
            <div class="tab active" data-tab="comments">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</div>
            <div class="tab" data-tab="finance">–§–∏–Ω–∞–Ω—Å—ã</div>
            <div class="tab" data-tab="materials">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
            <div class="tab" data-tab="contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
        </div>

        <div class="tab-content active" id="comments-tab">
            <!-- –ë–ª–æ–∫ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ -->
            <div class="project-description-section">
                <div class="section-header">
                    <h3>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</h3>
                    <button class="edit-btn" onclick="toggleEditMode('project-description')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="project-description-content">
                    <div class="description-field">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</label>
                        <div class="field-content">
                            <span class="field-value" id="project-name-display">–î–∏–≤–∞–Ω "–ù–µ–∞–ø–æ–ª—å" —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω</span>
                            <input type="text" class="field-input" id="project-name-input" value="–î–∏–≤–∞–Ω "–ù–µ–∞–ø–æ–ª—å" —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω" style="display: none;">
                </div>
            </div>

                    <div class="description-field">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <div class="field-content">
                            <span class="field-value" id="project-description-display">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¥–∏–≤–∞–Ω —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω, –æ–±–∏–≤–∫–∞ –∏–∑ –≤–µ–ª—é—Ä–∞, —Ü–≤–µ—Ç - —Ç–µ–º–Ω–æ-—Å–∏–Ω–∏–π. –†–∞–∑–º–µ—Ä—ã: 200x90x85 —Å–º. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –ø–æ–¥—É—à–∫–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ, –Ω–æ–∂–∫–∏ –∏–∑ –º–∞—Å—Å–∏–≤–∞ –¥—É–±–∞.</span>
                            <textarea class="field-textarea" id="project-description-input" style="display: none;">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¥–∏–≤–∞–Ω —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω, –æ–±–∏–≤–∫–∞ –∏–∑ –≤–µ–ª—é—Ä–∞, —Ü–≤–µ—Ç - —Ç–µ–º–Ω–æ-—Å–∏–Ω–∏–π. –†–∞–∑–º–µ—Ä—ã: 200x90x85 —Å–º. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –ø–æ–¥—É—à–∫–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ, –Ω–æ–∂–∫–∏ –∏–∑ –º–∞—Å—Å–∏–≤–∞ –¥—É–±–∞.</textarea>
                        </div>
                    </div>
                    
                    <div class="description-field">
                        <label>–û—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</label>
                        <div class="field-content">
                            <span class="field-value" id="project-requirements-display">–î–æ—Å—Ç–∞–≤–∫–∞ –≤ —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω–æ–º –≤–∏–¥–µ, —Å–±–æ—Ä–∫–∞ –Ω–∞ –º–µ—Å—Ç–µ. –ì–∞—Ä–∞–Ω—Ç–∏—è 2 –≥–æ–¥–∞.</span>
                            <textarea class="field-textarea" id="project-requirements-input" style="display: none;">–î–æ—Å—Ç–∞–≤–∫–∞ –≤ —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω–æ–º –≤–∏–¥–µ, —Å–±–æ—Ä–∫–∞ –Ω–∞ –º–µ—Å—Ç–µ. –ì–∞—Ä–∞–Ω—Ç–∏—è 2 –≥–æ–¥–∞.</textarea>
                        </div>
                    </div>
                    
                    <div class="description-actions" id="project-description-actions" style="display: none;">
                        <button class="btn btn-secondary" onclick="cancelEdit('project-description')">–û—Ç–º–µ–Ω–∞</button>
                        <button class="btn btn-primary" onclick="saveProjectDescription()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            </div>
                            </div>
                        </div>
            
            <!-- –ß–µ—Ä—Ç–µ–∂–∏ –∏ —Ñ–∞–π–ª—ã -->
            <div class="drawings-section">
                <div class="section-header">
                    <h3>–ß–µ—Ä—Ç–µ–∂–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã</h3>
                    <button class="add-file-btn" onclick="addNewFile()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                        </svg>
                        –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª
                    </button>
                </div>
                
                <div class="files-list" id="files-list">
                    <div class="file-download">
                        <div class="file-info">
                            <div class="file-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                    <polyline points="10 9 9 9 8 9"></polyline>
                                </svg>
                            </div>
                            <div>
                                <div class="file-name">–ß–µ—Ä—Ç–µ–∂ –¥–∏–≤–∞–Ω–∞.pdf</div>
                                <div class="file-size">2.4 –ú–ë</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button class="download-btn">–°–∫–∞—á–∞—Ç—å</button>
                            <button class="delete-btn" onclick="deleteFile(this)">√ó</button>
                        </div>
                    </div>
                    
                    <div class="file-download">
                        <div class="file-info">
                            <div class="file-icon">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="16" y1="13" x2="8" y2="13"></line>
                                    <line x1="16" y1="17" x2="8" y2="17"></line>
                                </svg>
                            </div>
                            <div>
                                <div class="file-name">–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.xlsx</div>
                                <div class="file-size">156 –ö–ë</div>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button class="download-btn">–°–∫–∞—á–∞—Ç—å</button>
                            <button class="delete-btn" onclick="deleteFile(this)">√ó</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
            <div class="comments-section">
                <div class="section-header">
                    <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
                    <button class="add-comment-btn" onclick="addNewComment()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            <line x1="13" y1="8" x2="13" y2="16"></line>
                            <line x1="9" y1="12" x2="17" y2="12"></line>
                                </svg>
                        –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
                    </button>
                            </div>
                
                <div class="comments-list" id="comments-list">
                    <div class="comment">
                        <div class="comment-header">
                            <span class="comment-author">–ú–µ–Ω–µ–¥–∂–µ—Ä</span>
                            <span class="comment-time">10.09.2023 14:30</span>
                            </div>
                        <div class="comment-text">
                            –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∑–∞–∫–∞–∑. –ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –≤–Ω–µ—Å–µ–Ω–∞.
                        </div>
                    </div>
                    
                    <div class="comment">
                        <div class="comment-header">
                            <span class="comment-author">–ê–ª–µ–∫—Å–µ–π –ß–µ—Ä–Ω–æ–≤</span>
                            <span class="comment-time">11.09.2023 10:15</span>
                        </div>
                        <div class="comment-text">
                            –£—Ç–æ—á–Ω–∏–ª –¥–µ—Ç–∞–ª–∏ –ø–æ —Ü–≤–µ—Ç—É –æ–±–∏–≤–∫–∏. –û—Ç–ø—Ä–∞–≤–∏–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞ –ø–æ—á—Ç—É.
                        </div>
                    </div>
                        </div>
                    </div>
                </div>

        <div class="tab-content" id="finance-tab">
            <!-- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –±–ª–æ–∫ -->
            <div class="finance-section">
                <div class="section-header">
                    <h3>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <button class="edit-btn" onclick="toggleEditMode('finance-section')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ -->
                <div class="finance-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="1" x2="12" y2="23"></line>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="finance-total-amount">42 500 ‚ÇΩ</div>
                            <div class="stat-label">–û–±—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12,6 12,12 16,14"></polyline>
                            </svg>
                    </div>
                        <div class="stat-content">
                            <div class="stat-value" id="finance-prepayment">15 000 ‚ÇΩ</div>
                            <div class="stat-label">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞</div>
                    </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                                <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                            </svg>
                    </div>
                        <div class="stat-content">
                            <div class="stat-value" id="finance-remaining">27 500 ‚ÇΩ</div>
                            <div class="stat-label">–û—Å—Ç–∞—Ç–æ–∫ –∫ –æ–ø–ª–∞—Ç–µ</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                            </svg>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="finance-prepayment-percent">35%</div>
                            <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã</div>
                </div>
            </div>
        </div>

                <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                <div class="finance-details">
                    <div class="detail-field">
                        <label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label>
                        <div class="field-content">
                            <span class="field-value" id="payment-method-display">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</span>
                            <select class="field-select" id="payment-method-input" style="display: none;">
                                <option value="bank_transfer">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</option>
                                <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option>
                                <option value="card">–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</option>
                                <option value="installment">–†–∞—Å—Å—Ä–æ—á–∫–∞</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="detail-field">
                        <label>–î–∞—Ç–∞ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã</label>
                        <div class="field-content">
                            <span class="field-value" id="prepayment-date-display">15.09.2023</span>
                            <input type="date" class="field-input" id="prepayment-date-input" value="2023-09-15" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="detail-field">
                        <label>–ù–æ–º–µ—Ä —Å—á–µ—Ç–∞</label>
                        <div class="field-content">
                            <span class="field-value" id="invoice-number-display">‚Ññ 12345 –æ—Ç 10.09.2023</span>
                            <input type="text" class="field-input" id="invoice-number-input" value="‚Ññ 12345 –æ—Ç 10.09.2023" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="detail-field">
                        <label>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç—ã</label>
                        <div class="field-content">
                            <span class="field-value" id="final-payment-date-display">–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞</span>
                            <input type="date" class="field-input" id="final-payment-date-input" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="detail-field">
                        <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –æ–ø–ª–∞—Ç–µ</label>
                        <div class="field-content">
                            <span class="field-value" id="payment-comment-display">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –≤–Ω–µ—Å–µ–Ω–∞ –≤ –ø–æ–ª–Ω–æ–º –æ–±—ä–µ–º–µ</span>
                            <textarea class="field-textarea" id="payment-comment-input" style="display: none;">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –≤–Ω–µ—Å–µ–Ω–∞ –≤ –ø–æ–ª–Ω–æ–º –æ–±—ä–µ–º–µ</textarea>
                        </div>
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="finance-actions" id="finance-section-actions" style="display: none;">
                    <button class="btn btn-secondary" onclick="cancelEdit('finance-section')">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="saveFinanceData()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
            
            <!-- –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π -->
            <div class="payments-history-section">
                <div class="section-header">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π</h3>
                    <button class="add-payment-btn" onclick="addNewPayment()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                        –î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂
            </button>
                </div>
                
                <div class="payments-list" id="payments-list">
                    <div class="payment-item">
                        <div class="payment-info">
                            <div class="payment-amount">15 000 ‚ÇΩ</div>
                            <div class="payment-type">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞</div>
                        </div>
                        <div class="payment-details">
                            <div class="payment-date">15.09.2023</div>
                            <div class="payment-method">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</div>
                        </div>
                        <div class="payment-actions">
                            <button class="edit-payment-btn" onclick="editPayment(this)">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>
                            <button class="delete-payment-btn" onclick="deletePayment(this)">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="3,6 5,6 21,6"></polyline>
                                    <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                                    <line x1="10" y1="11" x2="10" y2="17"></line>
                                    <line x1="14" y1="11" x2="14" y2="17"></line>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="materials-tab">
            <!-- –ë–ª–æ–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ -->
            <div class="materials-section">
                <div class="section-header">
                    <h3>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</h3>
                    <button class="add-material-btn" onclick="addNewMaterial()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª
                    </button>
                </div>
                
                <!-- –¢–∞–±–ª–∏—Ü–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ -->
                <div class="materials-table-container">
                    <table class="materials-table">
                        <thead>
                            <tr>
                                <th>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</th>
                                <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="materials-table-body">
                            <tr>
                                <td>–¢–∫–∞–Ω—å –º–µ–±–µ–ª—å–Ω–∞—è "–í–µ–ª—é—Ä"</td>
                                <td>15 –º</td>
                                <td>
                                    <button class="edit-material-btn" onclick="editMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                        </svg>
                                    </button>
                                    <button class="delete-material-btn" onclick="deleteMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="3,6 5,6 21,6"></polyline>
                                            <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                                            <line x1="10" y1="11" x2="10" y2="17"></line>
                                            <line x1="14" y1="11" x2="14" y2="17"></line>
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>–ù–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å —Ö–æ–ª–ª–æ—Ñ–∞–π–±–µ—Ä</td>
                                <td>8 –∫–≥</td>
                                <td>
                                    <button class="edit-material-btn" onclick="editMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                        </svg>
                                    </button>
                                    <button class="delete-material-btn" onclick="deleteMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="3,6 5,6 21,6"></polyline>
                                            <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                                            <line x1="10" y1="11" x2="10" y2="17"></line>
                                            <line x1="14" y1="11" x2="14" y2="17"></line>
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>–î–µ—Ä–µ–≤–æ –±—É–∫</td>
                                <td>2.5 –º¬≥</td>
                                <td>
                                    <button class="edit-material-btn" onclick="editMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                        </svg>
                                    </button>
                                    <button class="delete-material-btn" onclick="deleteMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="3,6 5,6 21,6"></polyline>
                                            <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                                            <line x1="10" y1="11" x2="10" y2="17"></line>
                                            <line x1="14" y1="11" x2="14" y2="17"></line>
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>–§—É—Ä–Ω–∏—Ç—É—Ä–∞ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∞—è</td>
                                <td>–∫–æ–º–ø–ª–µ–∫—Ç</td>
                                <td>
                                    <button class="edit-material-btn" onclick="editMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                        </svg>
                                    </button>
                                    <button class="delete-material-btn" onclick="deleteMaterial(this)">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polyline points="3,6 5,6 21,6"></polyline>
                                            <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                                            <line x1="10" y1="11" x2="10" y2="17"></line>
                                            <line x1="14" y1="11" x2="14" y2="17"></line>
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="tab-content" id="contacts-tab">
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ -->
            <div class="contacts-section">
                <div class="section-header">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ</h3>
                    <button class="edit-btn" onclick="toggleEditMode('contacts-section')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="contacts-info">
                    <div class="info-row">
                        <span class="info-label">–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞</span>
                        <div class="field-content">
                            <span class="info-value" id="client-name-display">–ê–ª–µ–∫—Å–µ–π –ß–µ—Ä–Ω–æ–≤</span>
                            <input type="text" class="field-input" id="client-name-input" value="–ê–ª–µ–∫—Å–µ–π –ß–µ—Ä–Ω–æ–≤" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–¢–µ–ª–µ—Ñ–æ–Ω</span>
                        <div class="field-content">
                            <span class="info-value" id="client-phone-display">+7 (912) 345-67-89</span>
                            <input type="tel" class="field-input" id="client-phone-input" value="+7 (912) 345-67-89" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">Email</span>
                        <div class="field-content">
                            <span class="info-value" id="client-email-display">alexey.chernov@example.com</span>
                            <input type="email" class="field-input" id="client-email-input" value="alexey.chernov@example.com" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç</span>
                        <div class="field-content">
                            <span class="info-value" id="client-additional-display">–ú–∞—Ä–∏—è (—Å—É–ø—Ä—É–≥–∞): +7 (912) 555-44-33</span>
                            <input type="text" class="field-input" id="client-additional-input" value="–ú–∞—Ä–∏—è (—Å—É–ø—Ä—É–≥–∞): +7 (912) 555-44-33" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏</span>
                        <div class="field-content">
                            <span class="info-value" id="client-preferred-display">Telegram/WhatsApp</span>
                            <select class="field-select" id="client-preferred-input" style="display: none;">
                                <option value="phone">–¢–µ–ª–µ—Ñ–æ–Ω</option>
                                <option value="email">Email</option>
                                <option value="telegram">Telegram</option>
                                <option value="whatsapp">WhatsApp</option>
                                <option value="viber">Viber</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="description-actions" id="contacts-section-actions" style="display: none;">
                        <button class="btn btn-secondary" onclick="cancelEdit('contacts-section')">–û—Ç–º–µ–Ω–∞</button>
                        <button class="btn btn-primary" onclick="saveContactsData()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ -->
            <div class="delivery-section">
                <div class="section-header">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç–∞–≤–∫–µ</h3>
                    <button class="edit-btn" onclick="toggleEditMode('delivery-section')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="delivery-info">
                    <div class="info-row">
                        <span class="info-label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                        <div class="field-content">
                            <span class="info-value" id="delivery-address-display">–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 45, –∫–≤. 18</span>
                            <textarea class="field-textarea" id="delivery-address-input" style="display: none;">–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 45, –∫–≤. 18</textarea>
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                        <div class="field-content">
                            <span class="info-value" id="delivery-date-display">25.09.2023</span>
                            <input type="date" class="field-input" id="delivery-date-input" value="2023-09-25" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                        <div class="field-content">
                            <span class="info-value" id="delivery-time-display">14:00 - 18:00</span>
                            <select class="field-select" id="delivery-time-input" style="display: none;">
                                <option value="09:00-12:00">09:00 - 12:00</option>
                                <option value="12:00-15:00">12:00 - 15:00</option>
                                <option value="14:00-18:00" selected>14:00 - 18:00</option>
                                <option value="18:00-21:00">18:00 - 21:00</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                        <div class="field-content">
                            <span class="info-value" id="delivery-method-display">–°–∞–º–æ–≤—ã–≤–æ–∑</span>
                            <select class="field-select" id="delivery-method-input" style="display: none;">
                                <option value="pickup">–°–∞–º–æ–≤—ã–≤–æ–∑</option>
                                <option value="courier">–ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</option>
                                <option value="transport">–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è</option>
                                <option value="post">–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                        <div class="field-content">
                            <span class="info-value" id="delivery-cost-display">0 ‚ÇΩ</span>
                            <input type="number" class="field-input" id="delivery-cost-input" value="0" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="info-row">
                        <span class="info-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ—Å—Ç–∞–≤–∫–µ</span>
                        <div class="field-content">
                            <span class="info-value" id="delivery-comment-display">–î–æ—Å—Ç–∞–≤–∫–∞ –≤ —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω–æ–º –≤–∏–¥–µ, —Å–±–æ—Ä–∫–∞ –Ω–∞ –º–µ—Å—Ç–µ</span>
                            <textarea class="field-textarea" id="delivery-comment-input" style="display: none;">–î–æ—Å—Ç–∞–≤–∫–∞ –≤ —Ä–∞–∑–æ–±—Ä–∞–Ω–Ω–æ–º –≤–∏–¥–µ, —Å–±–æ—Ä–∫–∞ –Ω–∞ –º–µ—Å—Ç–µ</textarea>
                        </div>
                    </div>
                    
                    <div class="description-actions" id="delivery-section-actions" style="display: none;">
                        <button class="btn btn-secondary" onclick="cancelEdit('delivery-section')">–û—Ç–º–µ–Ω–∞</button>
                        <button class="btn btn-primary" onclick="saveDeliveryData()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
    let activeCardId = null;
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—É–º–º—ã –≤ –∫–æ–ª–æ–Ω–∫–µ
    function updateColumnSums() {
        const columns = document.querySelectorAll('.kanban-column');
        
        columns.forEach(column => {
            const cards = column.querySelectorAll('.kanban-card');
            let total = 0;
            
            cards.forEach(card => {
                const amount = parseInt(card.getAttribute('data-card-amount') || '0');
                total += amount;
            });
            
            const sumElement = column.querySelector('.column-sum');
            if (sumElement) {
                sumElement.textContent = total.toLocaleString('ru-RU') + ' ‚ÇΩ';
            }
        });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∫–æ–ª–æ–Ω–∫–∏
    function startEditingColumnTitle(column) {
        const titleElement = column.querySelector('.column-title span:first-child');
        const currentTitle = titleElement.textContent;
        const countSpan = column.querySelector('.column-count');
        const sumSpan = column.querySelector('.column-sum');
        
        const input = document.createElement('input');
        input.type = 'text';
        input.value = currentTitle;
        input.className = 'column-title-input';
        
        // –ó–∞–º–µ–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞ input
        titleElement.replaceWith(input);
        
        input.focus();
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        input.addEventListener('blur', function() {
            finishEditingColumnTitle(input, countSpan, sumSpan);
        });
        
        input.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                finishEditingColumnTitle(input, countSpan, sumSpan);
            }
        });
    }
    
    function finishEditingColumnTitle(input, countSpan, sumSpan) {
        const newTitle = input.value || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
        const titleSpan = document.createElement('span');
        titleSpan.textContent = newTitle;
        
        input.replaceWith(titleSpan);
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∏ —Å—É–º–º—É
        if (countSpan) {
            titleSpan.after(countSpan);
        }
        if (sumSpan) {
            countSpan.after(sumSpan);
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏
    function toggleAddCardForm(element) {
        const column = element.closest('.kanban-column');
        const form = column.querySelector('.add-card-form');
        const isVisible = form.style.display === 'block';
        
        form.style.display = isVisible ? 'none' : 'block';
    }
    
    function cancelAddCard(button) {
        const form = button.closest('.add-card-form');
        form.style.display = 'none';
    }
    
    function addNewCard(button) {
        const form = button.closest('.add-card-form');
        const inputs = form.querySelectorAll('.form-input');
        
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Ñ–æ—Ä–º—ã
        alert('–ù–æ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å –≤–≤–µ–¥–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏');
        
        // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –∏ —Å–∫—Ä—ã–≤–∞–µ–º –µ–µ
        inputs.forEach(input => input.value = '');
        form.style.display = 'none';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—ã –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö
        updateColumnSums();
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª—å—é
    function openDetailPanel(card) {
        const panel = document.getElementById('detail-panel');
        const overlay = document.getElementById('overlay');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
        activeCardId = card.getAttribute('data-card-id');
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø–∞–Ω–µ–ª–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞)
        const clientName = card.querySelector('.client-name').textContent;
        const clientAvatar = card.querySelector('.client-avatar').textContent;
        const productName = card.querySelector('.card-title').textContent;
        const amount = card.querySelector('.card-amount').textContent;
        const prepayment = card.querySelector('.prepayment').textContent.replace('–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: ', '');
        const priority = card.querySelector('.card-priority').textContent;
        
        document.getElementById('detail-avatar').textContent = clientAvatar;
        document.getElementById('detail-client-name').textContent = clientName;
        document.getElementById('detail-product').textContent = productName;
        document.getElementById('detail-amount').textContent = amount;
        document.getElementById('detail-prepayment').textContent = prepayment;
        document.getElementById('detail-priority').textContent = priority;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∏ overlay
        panel.classList.add('active');
        overlay.classList.add('active');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∞–±—ã
        initTabs();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–∞—Ö
        updateTabData(card);
        
        // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ
        document.body.style.overflow = 'hidden';
    }
    
    function closeDetailPanel() {
        const panel = document.getElementById('detail-panel');
        const overlay = document.getElementById('overlay');
        
        panel.classList.remove('active');
        overlay.classList.remove('active');
        
        // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ
        document.body.style.overflow = '';
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏
    function deleteColumn(columnElement) {
        const columnId = columnElement.getAttribute('data-column-id');
        const columnTitle = columnElement.querySelector('.column-title span').textContent;
        const cardCount = columnElement.querySelectorAll('.kanban-card').length;
        
        // –°–ø–∏—Å–æ–∫ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è —É–¥–∞–ª—è—Ç—å
        const systemColumns = [
            '–ö–ë', '–°—Ç–æ–ª—è—Ä–Ω—ã–π —Ü–µ—Ö', '–§–æ—Ä–º–æ–≤–∫–∞', '–®–≤–µ–π–Ω—ã–π —Ü–µ—Ö', 
            '–û–±–∏–≤–∫–∞', '–°–±–æ—Ä–∫–∞ –∏ —É–ø–∞–∫–æ–≤–∫–∞', '–û—Ç–≥—Ä—É–∂–µ–Ω'
        ];
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–æ–ª–æ–Ω–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–π
        if (systemColumns.includes(columnTitle)) {
            alert(`–ö–æ–ª–æ–Ω–∫–∞ "${columnTitle}" —è–≤–ª—è–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω–∞.`);
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∫–æ–ª–æ–Ω–∫–µ
        if (cardCount > 0) {
            const confirmMessage = `–í –∫–æ–ª–æ–Ω–∫–µ "${columnTitle}" –µ—Å—Ç—å ${cardCount} –∫–∞—Ä—Ç–æ—á–µ–∫. –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–ª–æ–Ω–∫–∏ –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ –ø–µ—Ä–≤—É—é –∫–æ–ª–æ–Ω–∫—É. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?`;
            if (!confirm(confirmMessage)) {
                return;
            }
            
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –ø–µ—Ä–≤—É—é –∫–æ–ª–æ–Ω–∫—É
            const firstColumn = document.querySelector('.kanban-column[data-column-id="1"]');
            if (firstColumn) {
                const firstColumnCards = firstColumn.querySelector('.kanban-cards');
                const cardsToMove = columnElement.querySelectorAll('.kanban-card');
                
                cardsToMove.forEach(card => {
                    firstColumnCards.appendChild(card);
                });
            }
        }
        
        // –£–¥–∞–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É
        columnElement.remove();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º ID –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–æ–ª–æ–Ω–æ–∫
        updateColumnIds();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—ã –∏ —Å—á–µ—Ç—á–∏–∫–∏
        updateColumnSums();
        updateColumnCounts();
        
        console.log(`–ö–æ–ª–æ–Ω–∫–∞ "${columnTitle}" —É–¥–∞–ª–µ–Ω–∞`);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ID –∫–æ–ª–æ–Ω–æ–∫ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
    function updateColumnIds() {
        const columns = document.querySelectorAll('.kanban-column');
        columns.forEach((column, index) => {
            const newId = index + 1;
            column.setAttribute('data-column-id', newId);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º ID –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö —Å—É–º–º—ã –∏ —Å—á–µ—Ç—á–∏–∫–∞
            const sumElement = column.querySelector('.column-sum');
            const countElement = column.querySelector('.column-count');
            
            if (sumElement) {
                sumElement.id = `column-sum-${newId}`;
            }
            if (countElement) {
                countElement.id = `column-count-${newId}`;
            }
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏
    function createNewColumn() {
        const kanbanBoard = document.getElementById('kanban-board');
        const columnCount = kanbanBoard.querySelectorAll('.kanban-column').length;
        const newColumnId = columnCount + 1;
        
        const newColumn = document.createElement('div');
        newColumn.className = 'kanban-column';
        newColumn.setAttribute('data-column-id', newColumnId);
        
        newColumn.innerHTML = `
            <div class="column-header">
                <div class="column-title">
                    <span>–ù–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞</span>
                    <span class="column-sum">0 ‚ÇΩ</span>
                    <span class="column-count">0</span>
                </div>
                <div class="column-actions">
                    <div class="column-action" onclick="startEditingColumnTitle(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </div>
                    <div class="column-action" onclick="toggleAddCardForm(this)">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"></path>
                        </svg>
                    </div>
                    <div class="column-action column-delete" onclick="deleteColumn(this.closest('.kanban-column'))">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2M10 11v6M14 11v6"></path>
                        </svg>
                    </div>
                </div>
            </div>
            <div class="kanban-cards"></div>
            <div class="add-card-form" style="display: none;">
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è">
                </div>
                <div class="form-group">
                    <input type="number" class="form-input" placeholder="–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞">
                </div>
                <div class="form-group">
                    <input type="number" class="form-input" placeholder="–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞">
                </div>
                <div class="form-group">
                    <select class="form-input">
                        <option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                        <option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                    </select>
                </div>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞">
                </div>
                <div class="form-actions">
                    <button class="btn btn-secondary" onclick="cancelAddCard(this)">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn btn-primary" onclick="addNewCard(this)">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        `;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É –≤ –¥–æ—Å–∫—É
        kanbanBoard.appendChild(newColumn);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –¥–ª—è –Ω–æ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏
        initColumnDragAndDrop(newColumn);
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏
        closeDetailPanel();
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–±–æ–≤
    function initTabs() {
        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        document.querySelectorAll('.tab').forEach(tab => {
            tab.removeEventListener('click', handleTabClick);
        });
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', handleTabClick);
        });
    }
    
    function handleTabClick() {
        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Ç–∞–±–æ–≤
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–º—É —Ç–∞–±—É
        this.classList.add('active');
        
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–æ–≤
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∞–±–∞
        const tabId = this.getAttribute('data-tab');
        const targetTab = document.getElementById(`${tabId}-tab`);
        if (targetTab) {
            targetTab.classList.add('active');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–∞—Ö
    function updateTabData(card) {
        const clientName = card.querySelector('.client-name').textContent;
        const amount = card.querySelector('.card-amount').textContent;
        const prepayment = card.querySelector('.prepayment').textContent.replace('–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: ', '');
        const productName = card.querySelector('.card-title').textContent;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–µ "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏" (–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞)
        updateProjectDescription(productName);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–µ "–§–∏–Ω–∞–Ω—Å—ã"
        updateFinanceData(amount, prepayment);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–µ "–ö–æ–Ω—Ç–∞–∫—Ç—ã"
        updateContactsData(clientName);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    function updateContactsData(clientName) {
        const nameDisplay = document.getElementById('client-name-display');
        const nameInput = document.getElementById('client-name-input');
        
        if (nameDisplay && nameInput) {
            nameDisplay.textContent = clientName;
            nameInput.value = clientName;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏
        const avatarElement = document.getElementById('detail-avatar');
        if (avatarElement) {
            const initials = clientName.split(' ').map(word => word[0]).join('').toUpperCase();
            avatarElement.textContent = initials;
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    function updateFinanceData(amount, prepayment) {
        const totalAmountElement = document.getElementById('finance-total-amount');
        const prepaymentElement = document.getElementById('finance-prepayment');
        
        if (totalAmountElement) totalAmountElement.textContent = amount;
        if (prepaymentElement) prepaymentElement.textContent = prepayment;
        
        // –í—ã—á–∏—Å–ª—è–µ–º –æ—Å—Ç–∞—Ç–æ–∫ –∫ –æ–ø–ª–∞—Ç–µ
        const totalAmount = parseFloat(amount.replace(/[^\d]/g, ''));
        const prepaymentAmount = parseFloat(prepayment.replace(/[^\d]/g, ''));
        const remaining = totalAmount - prepaymentAmount;
        const prepaymentPercent = Math.round((prepaymentAmount / totalAmount) * 100);
        
        const remainingElement = document.getElementById('finance-remaining');
        const percentElement = document.getElementById('finance-prepayment-percent');
        
        if (remainingElement) remainingElement.textContent = remaining.toLocaleString('ru-RU') + ' ‚ÇΩ';
        if (percentElement) percentElement.textContent = prepaymentPercent + '%';
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
    function updateProjectDescription(productName) {
        const nameDisplay = document.getElementById('project-name-display');
        const nameInput = document.getElementById('project-name-input');
        
        if (nameDisplay && nameInput) {
            nameDisplay.textContent = productName;
            nameInput.value = productName;
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
    function toggleEditMode(section) {
        const actions = document.getElementById(`${section}-actions`);
        const displayElements = document.querySelectorAll(`#${section} .field-value`);
        const inputElements = document.querySelectorAll(`#${section} .field-input, #${section} .field-textarea`);
        
        if (actions && displayElements.length > 0 && inputElements.length > 0) {
            const isEditing = actions.style.display !== 'none';
            
            if (isEditing) {
                // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                displayElements.forEach(el => el.style.display = 'block');
                inputElements.forEach(el => el.style.display = 'none');
                actions.style.display = 'none';
            } else {
                // –í—Ö–æ–¥–∏–º –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                displayElements.forEach(el => el.style.display = 'none');
                inputElements.forEach(el => el.style.display = 'block');
                actions.style.display = 'flex';
            }
        }
    }
    
    function cancelEdit(section) {
        const actions = document.getElementById(`${section}-actions`);
        const displayElements = document.querySelectorAll(`#${section} .field-value`);
        const inputElements = document.querySelectorAll(`#${section} .field-input, #${section} .field-textarea`);
        
        if (actions && displayElements.length > 0 && inputElements.length > 0) {
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ display —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            inputElements.forEach((input, index) => {
                if (displayElements[index]) {
                    input.value = displayElements[index].textContent;
                }
            });
            
            // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            displayElements.forEach(el => el.style.display = 'block');
            inputElements.forEach(el => el.style.display = 'none');
            actions.style.display = 'none';
        }
    }
    
    function saveProjectDescription() {
        const nameDisplay = document.getElementById('project-name-display');
        const nameInput = document.getElementById('project-name-input');
        const descriptionDisplay = document.getElementById('project-description-display');
        const descriptionInput = document.getElementById('project-description-input');
        const requirementsDisplay = document.getElementById('project-requirements-display');
        const requirementsInput = document.getElementById('project-requirements-input');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
        if (nameDisplay && nameInput) {
            nameDisplay.textContent = nameInput.value;
        }
        if (descriptionDisplay && descriptionInput) {
            descriptionDisplay.textContent = descriptionInput.value;
        }
        if (requirementsDisplay && requirementsInput) {
            requirementsDisplay.textContent = requirementsInput.value;
        }
        
        // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        toggleEditMode('project-description');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
        updateCardProjectData();
        
        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        console.log('–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ:', {
            name: nameInput.value,
            description: descriptionInput.value,
            requirements: requirementsInput.value
        });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
    function updateCardProjectData() {
        if (activeCardId) {
            const activeCard = document.querySelector(`[data-card-id="${activeCardId}"]`);
            if (activeCard) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
                const titleElement = activeCard.querySelector('.card-title');
                const projectNameDisplay = document.getElementById('project-name-display');
                
                if (titleElement && projectNameDisplay) {
                    titleElement.textContent = projectNameDisplay.textContent;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏
                const detailProduct = document.getElementById('detail-product');
                if (detailProduct && projectNameDisplay) {
                    detailProduct.textContent = projectNameDisplay.textContent;
                }
            }
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
    function addNewFile() {
        const input = document.createElement('input');
        input.type = 'file';
        input.multiple = true;
        input.accept = '.pdf,.doc,.docx,.xlsx,.jpg,.png,.dwg';
        
        input.onchange = function(e) {
            Array.from(e.target.files).forEach(file => {
                addFileToList(file);
            });
        };
        
        input.click();
    }
    
    function addFileToList(file) {
        const filesList = document.getElementById('files-list');
        if (!filesList) return;
        
        const fileItem = document.createElement('div');
        fileItem.className = 'file-download';
        
        const fileSize = (file.size / 1024 / 1024).toFixed(1) + ' –ú–ë';
        
        fileItem.innerHTML = `
            <div class="file-info">
                <div class="file-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                    </svg>
                </div>
                <div>
                    <div class="file-name">${file.name}</div>
                    <div class="file-size">${fileSize}</div>
                </div>
            </div>
            <div class="file-actions">
                <button class="download-btn">–°–∫–∞—á–∞—Ç—å</button>
                <button class="delete-btn" onclick="deleteFile(this)">√ó</button>
            </div>
        `;
        
        filesList.appendChild(fileItem);
    }
    
    function deleteFile(button) {
        const fileItem = button.closest('.file-download');
        if (fileItem) {
            fileItem.remove();
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
    function addNewComment() {
        const commentText = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:');
        if (commentText && commentText.trim()) {
            addCommentToList(commentText, '–¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å');
        }
    }
    
    function addCommentToList(text, author) {
        const commentsList = document.getElementById('comments-list');
        if (!commentsList) return;
        
        const commentItem = document.createElement('div');
        commentItem.className = 'comment';
        
        const now = new Date();
        const timeString = now.toLocaleDateString('ru-RU') + ' ' + now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'});
        
        commentItem.innerHTML = `
            <div class="comment-header">
                <span class="comment-author">${author}</span>
                <span class="comment-time">${timeString}</span>
            </div>
            <div class="comment-text">${text}</div>
        `;
        
        commentsList.appendChild(commentItem);
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏
    function addNewMaterial() {
        const name = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:');
        if (name && name.trim()) {
            const quantity = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:');
            if (quantity && quantity.trim()) {
                addMaterialToList(name.trim(), quantity.trim());
            }
        }
    }
    
    function addMaterialToList(name, quantity) {
        const tableBody = document.getElementById('materials-table-body');
        if (!tableBody) return;
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${name}</td>
            <td>${quantity}</td>
            <td class="actions-cell">
                <button class="edit-material-btn" onclick="editMaterial(this)">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                </button>
                <button class="delete-material-btn" onclick="deleteMaterial(this)">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3,6 5,6 21,6"></polyline>
                        <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                </button>
            </td>
        `;
        
        tableBody.appendChild(row);
    }
    
    function editMaterial(button) {
        const row = button.closest('tr');
        const nameCell = row.cells[0];
        const quantityCell = row.cells[1];
        
        const currentName = nameCell.textContent;
        const currentQuantity = quantityCell.textContent;
        
        const newName = prompt('–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:', currentName);
        if (newName !== null) {
            const newQuantity = prompt('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:', currentQuantity);
            if (newQuantity !== null) {
                nameCell.textContent = newName;
                quantityCell.textContent = newQuantity;
            }
        }
    }
    
    function deleteMaterial(button) {
        if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª?')) {
            const row = button.closest('tr');
            row.remove();
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    function saveFinanceData() {
        const paymentMethodDisplay = document.getElementById('payment-method-display');
        const paymentMethodInput = document.getElementById('payment-method-input');
        const prepaymentDateDisplay = document.getElementById('prepayment-date-display');
        const prepaymentDateInput = document.getElementById('prepayment-date-input');
        const invoiceNumberDisplay = document.getElementById('invoice-number-display');
        const invoiceNumberInput = document.getElementById('invoice-number-input');
        const finalPaymentDateDisplay = document.getElementById('final-payment-date-display');
        const finalPaymentDateInput = document.getElementById('final-payment-date-input');
        const paymentCommentDisplay = document.getElementById('payment-comment-display');
        const paymentCommentInput = document.getElementById('payment-comment-input');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
        if (paymentMethodDisplay && paymentMethodInput) {
            const selectedOption = paymentMethodInput.options[paymentMethodInput.selectedIndex];
            paymentMethodDisplay.textContent = selectedOption.text;
        }
        if (prepaymentDateDisplay && prepaymentDateInput) {
            const date = new Date(prepaymentDateInput.value);
            prepaymentDateDisplay.textContent = date.toLocaleDateString('ru-RU');
        }
        if (invoiceNumberDisplay && invoiceNumberInput) {
            invoiceNumberDisplay.textContent = invoiceNumberInput.value;
        }
        if (finalPaymentDateDisplay && finalPaymentDateInput) {
            if (finalPaymentDateInput.value) {
                const date = new Date(finalPaymentDateInput.value);
                finalPaymentDateDisplay.textContent = date.toLocaleDateString('ru-RU');
            } else {
                finalPaymentDateDisplay.textContent = '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞';
            }
        }
        if (paymentCommentDisplay && paymentCommentInput) {
            paymentCommentDisplay.textContent = paymentCommentInput.value;
        }
        
        // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        toggleEditMode('finance-section');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
        updateCardFinanceData();
        
        console.log('–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤–µ—Ç–æ–∫ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
    function updateCardBranches(cardElement, branches) {
        const branchesContainer = cardElement.querySelector('.card-branches');
        if (!branchesContainer) return;
        
        const frameStatus = branchesContainer.querySelector('.branch-item:first-child .branch-status');
        const upholsteryStatus = branchesContainer.querySelector('.branch-item:last-child .branch-status');
        
        if (frameStatus) {
            frameStatus.className = 'branch-status';
            switch (branches.frame) {
                case 'not_started':
                    frameStatus.classList.add('status-not-started');
                    frameStatus.textContent = '–ù–µ –Ω–∞—á–∞—Ç';
                    break;
                case 'in_progress':
                    frameStatus.classList.add('status-in-progress');
                    frameStatus.textContent = '–í —Ä–∞–±–æ—Ç–µ';
                    break;
                case 'completed':
                    frameStatus.classList.add('status-completed');
                    frameStatus.textContent = '–ì–æ—Ç–æ–≤';
                    break;
            }
        }
        
        if (upholsteryStatus) {
            upholsteryStatus.className = 'branch-status';
            switch (branches.upholstery) {
                case 'not_started':
                    upholsteryStatus.classList.add('status-not-started');
                    upholsteryStatus.textContent = '–ù–µ –Ω–∞—á–∞—Ç';
                    break;
                case 'in_progress':
                    upholsteryStatus.classList.add('status-in-progress');
                    upholsteryStatus.textContent = '–í —Ä–∞–±–æ—Ç–µ';
                    break;
                case 'completed':
                    upholsteryStatus.classList.add('status-completed');
                    upholsteryStatus.textContent = '–ì–æ—Ç–æ–≤';
                    break;
            }
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
    function updateCardFinanceData() {
        if (activeCardId) {
            const activeCard = document.querySelector(`[data-card-id="${activeCardId}"]`);
            if (activeCard) {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—É –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
                const amountElement = activeCard.querySelector('.card-amount');
                const prepaymentElement = activeCard.querySelector('.prepayment');
                
                if (amountElement) {
                    const totalAmount = document.getElementById('finance-total-amount');
                    if (totalAmount) {
                        amountElement.textContent = totalAmount.textContent;
                        // –û–±–Ω–æ–≤–ª—è–µ–º data-–∞—Ç—Ä–∏–±—É—Ç –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞ —Å—É–º–º –∫–æ–ª–æ–Ω–æ–∫
                        const amountValue = totalAmount.textContent.replace(/[^\d]/g, '');
                        activeCard.setAttribute('data-card-amount', amountValue);
                    }
                }
                
                if (prepaymentElement) {
                    const prepaymentAmount = document.getElementById('finance-prepayment');
                    if (prepaymentAmount) {
                        prepaymentElement.textContent = '–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: ' + prepaymentAmount.textContent;
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏
                const detailAmount = document.getElementById('detail-amount');
                const detailPrepayment = document.getElementById('detail-prepayment');
                
                if (detailAmount && amountElement) {
                    detailAmount.textContent = amountElement.textContent;
                }
                if (detailPrepayment && prepaymentElement) {
                    detailPrepayment.textContent = prepaymentElement.textContent.replace('–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: ', '');
                }
                
                // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—É–º–º—ã –∫–æ–ª–æ–Ω–æ–∫
                updateColumnSums();
            }
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    function saveContactsData() {
        const nameDisplay = document.getElementById('client-name-display');
        const nameInput = document.getElementById('client-name-input');
        const phoneDisplay = document.getElementById('client-phone-display');
        const phoneInput = document.getElementById('client-phone-input');
        const emailDisplay = document.getElementById('client-email-display');
        const emailInput = document.getElementById('client-email-input');
        const additionalDisplay = document.getElementById('client-additional-display');
        const additionalInput = document.getElementById('client-additional-input');
        const preferredDisplay = document.getElementById('client-preferred-display');
        const preferredInput = document.getElementById('client-preferred-input');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
        if (nameDisplay && nameInput) {
            nameDisplay.textContent = nameInput.value;
        }
        if (phoneDisplay && phoneInput) {
            phoneDisplay.textContent = phoneInput.value;
        }
        if (emailDisplay && emailInput) {
            emailDisplay.textContent = emailInput.value;
        }
        if (additionalDisplay && additionalInput) {
            additionalDisplay.textContent = additionalInput.value;
        }
        if (preferredDisplay && preferredInput) {
            const selectedOption = preferredInput.options[preferredInput.selectedIndex];
            preferredDisplay.textContent = selectedOption.text;
        }
        
        // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        toggleEditMode('contacts-section');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ
        updateCardClientData(nameInput.value);
        
        console.log('–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
    function saveDeliveryData() {
        const addressDisplay = document.getElementById('delivery-address-display');
        const addressInput = document.getElementById('delivery-address-input');
        const dateDisplay = document.getElementById('delivery-date-display');
        const dateInput = document.getElementById('delivery-date-input');
        const timeDisplay = document.getElementById('delivery-time-display');
        const timeInput = document.getElementById('delivery-time-input');
        const methodDisplay = document.getElementById('delivery-method-display');
        const methodInput = document.getElementById('delivery-method-input');
        const costDisplay = document.getElementById('delivery-cost-display');
        const costInput = document.getElementById('delivery-cost-input');
        const commentDisplay = document.getElementById('delivery-comment-display');
        const commentInput = document.getElementById('delivery-comment-input');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
        if (addressDisplay && addressInput) {
            addressDisplay.textContent = addressInput.value;
        }
        if (dateDisplay && dateInput) {
            const date = new Date(dateInput.value);
            dateDisplay.textContent = date.toLocaleDateString('ru-RU');
        }
        if (timeDisplay && timeInput) {
            const selectedOption = timeInput.options[timeInput.selectedIndex];
            timeDisplay.textContent = selectedOption.text;
        }
        if (methodDisplay && methodInput) {
            const selectedOption = methodInput.options[methodInput.selectedIndex];
            methodDisplay.textContent = selectedOption.text;
        }
        if (costDisplay && costInput) {
            costDisplay.textContent = costInput.value + ' ‚ÇΩ';
        }
        if (commentDisplay && commentInput) {
            commentDisplay.textContent = commentInput.value;
        }
        
        // –í—ã—Ö–æ–¥–∏–º –∏–∑ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        toggleEditMode('delivery-section');
        
        console.log('–î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ
    function updateCardClientData(clientName) {
        // –ù–∞—Ö–æ–¥–∏–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–º—É ID
        if (activeCardId) {
            const activeCard = document.querySelector(`[data-card-id="${activeCardId}"]`);
            if (activeCard) {
                const clientNameElement = activeCard.querySelector('.client-name');
                if (clientNameElement) {
                    clientNameElement.textContent = clientName;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä (–ø–µ—Ä–≤—ã–µ –±—É–∫–≤—ã –∏–º–µ–Ω–∏)
                const avatarElement = activeCard.querySelector('.client-avatar');
                if (avatarElement) {
                    const initials = clientName.split(' ').map(word => word[0]).join('').toUpperCase();
                    avatarElement.textContent = initials;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏
                const detailClientName = document.getElementById('detail-client-name');
                const detailAvatar = document.getElementById('detail-avatar');
                
                if (detailClientName) {
                    detailClientName.textContent = clientName;
                }
                if (detailAvatar) {
                    detailAvatar.textContent = initials;
                }
            }
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏
    function addNewPayment() {
        const amount = prompt('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–ª–∞—Ç–µ–∂–∞:');
        if (amount && amount.trim()) {
            const type = prompt('–¢–∏–ø –ø–ª–∞—Ç–µ–∂–∞ (–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞, –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç–µ–∂, –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π):', '–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞');
            if (type && type.trim()) {
                const method = prompt('–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:', '–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥');
                if (method && method.trim()) {
                    addPaymentToList(amount.trim(), type.trim(), method.trim());
                }
            }
        }
    }
    
    function addPaymentToList(amount, type, method) {
        const paymentsList = document.getElementById('payments-list');
        if (!paymentsList) return;
        
        const paymentItem = document.createElement('div');
        paymentItem.className = 'payment-item';
        
        const now = new Date();
        const dateString = now.toLocaleDateString('ru-RU');
        
        paymentItem.innerHTML = `
            <div class="payment-info">
                <div class="payment-amount">${amount} ‚ÇΩ</div>
                <div class="payment-type">${type}</div>
            </div>
            <div class="payment-details">
                <div class="payment-date">${dateString}</div>
                <div class="payment-method">${method}</div>
            </div>
            <div class="payment-actions">
                <button class="edit-payment-btn" onclick="editPayment(this)">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                </button>
                <button class="delete-payment-btn" onclick="deletePayment(this)">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3,6 5,6 21,6"></polyline>
                        <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                </button>
            </div>
        `;
        
        paymentsList.appendChild(paymentItem);
    }
    
    function editPayment(button) {
        const paymentItem = button.closest('.payment-item');
        const amountElement = paymentItem.querySelector('.payment-amount');
        const typeElement = paymentItem.querySelector('.payment-type');
        const methodElement = paymentItem.querySelector('.payment-method');
        
        const currentAmount = amountElement.textContent.replace(' ‚ÇΩ', '');
        const currentType = typeElement.textContent;
        const currentMethod = methodElement.textContent;
        
        const newAmount = prompt('–°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞:', currentAmount);
        if (newAmount !== null) {
            const newType = prompt('–¢–∏–ø –ø–ª–∞—Ç–µ–∂–∞:', currentType);
            if (newType !== null) {
                const newMethod = prompt('–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:', currentMethod);
                if (newMethod !== null) {
                    amountElement.textContent = newAmount + ' ‚ÇΩ';
                    typeElement.textContent = newType;
                    methodElement.textContent = newMethod;
                }
            }
        }
    }
    
    function deletePayment(button) {
        if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–ª–∞—Ç–µ–∂?')) {
            const paymentItem = button.closest('.payment-item');
            paymentItem.remove();
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
    function initColumnDragAndDrop(column) {
        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
        column.removeEventListener('dragover', handleDragOver);
        column.removeEventListener('dragleave', handleDragLeave);
        column.removeEventListener('drop', handleDrop);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        column.addEventListener('dragover', handleDragOver);
        column.addEventListener('dragleave', handleDragLeave);
        column.addEventListener('drop', handleDrop);
    }
    
    function handleDragOver(e) {
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        this.classList.add('drop-area');
    }
    
    function handleDragLeave(e) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∏–Ω—É–ª–∏ –∫–æ–ª–æ–Ω–∫—É, –∞ –Ω–µ –ø–µ—Ä–µ—à–ª–∏ –∫ –¥–æ—á–µ—Ä–Ω–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
        if (!this.contains(e.relatedTarget)) {
            this.classList.remove('drop-area');
        }
    }
    
    function handleDrop(e) {
        e.preventDefault();
        this.classList.remove('drop-area');
        
        const cardId = e.dataTransfer.getData('text/plain');
        const draggedCard = document.querySelector(`[data-card-id="${cardId}"]`);
        
        if (draggedCard) {
            const cardsContainer = this.querySelector('.kanban-cards');
            if (cardsContainer) {
                cardsContainer.appendChild(draggedCard);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ —Å—É–º–º—ã
                updateColumnCounts();
                updateColumnSums();
            }
        }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        let draggedCard = null;
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ drag & drop
        function initDragAndDrop() {
            const cards = document.querySelectorAll('.kanban-card');
            const columns = document.querySelectorAll('.kanban-column');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫
            cards.forEach(card => {
                card.addEventListener('dragstart', function(e) {
                    draggedCard = this;
                    this.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/plain', this.dataset.cardId);
                });
                
                card.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    columns.forEach(col => col.classList.remove('drop-area'));
                    draggedCard = null;
                });
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫
            columns.forEach(column => {
                initColumnDragAndDrop(column);
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º drag & drop
        initDragAndDrop();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∞–±—ã
        initTabs();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—É–º–º—ã –∫–æ–ª–æ–Ω–æ–∫
        updateColumnSums();
        updateColumnCounts();
        
        // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º drag & drop –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList') {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ–±–∞–≤–∏–ª–∏—Å—å –ª–∏ –Ω–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
                    const newCards = Array.from(mutation.addedNodes).filter(node => 
                        node.nodeType === 1 && node.classList && node.classList.contains('kanban-card')
                    );
                    if (newCards.length > 0) {
                        initDragAndDrop();
                    }
                }
            });
        });
        
        // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –∫–∞–Ω–±–∞–Ω-–¥–æ—Å–∫–µ
        const kanbanBoard = document.getElementById('kanban-board');
        if (kanbanBoard) {
            observer.observe(kanbanBoard, { childList: true, subtree: true });
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏—à–∏ Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeDetailPanel();
            }
        });
    });
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö
    function updateColumnCounts() {
        const columns = document.querySelectorAll('.kanban-column');
        
        columns.forEach(column => {
            const cardsCount = column.querySelectorAll('.kanban-card').length;
            const countElement = column.querySelector('.column-count');
            
            if (countElement) {
                countElement.textContent = cardsCount;
            }
        });
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle.addEventListener('click', function() {
        document.body.classList.toggle('dark-theme');
        
        // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
        const themeText = themeToggle.querySelector('span');
        if (document.body.classList.contains('dark-theme')) {
            themeText.textContent = '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
        } else {
            themeText.textContent = '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞';
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Ç–µ–º—ã –≤ localStorage
        localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
    });
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–±–∞–Ω–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
    async function loadKanbanData() {
        try {
            // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ localStorage –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π
            const token = localStorage.getItem('token') || 'test-token';
            
            const response = await fetch('/api/orders/kanban', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                }
            });
            
            if (!response.ok) {
                throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–±–∞–Ω–∞');
            }
            
            const data = await response.json();
            console.log('–î–∞–Ω–Ω—ã–µ –∫–∞–Ω–±–∞–Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', data);
            
            // –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            document.querySelectorAll('.kanban-cards').forEach(container => {
                container.innerHTML = '';
            });
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–æ–ª–æ–Ω–∫–∏ –¥–∞–Ω–Ω—ã–º–∏
            data.columns.forEach(column => {
                const columnElement = document.querySelector(`[data-column-id="${column.id}"]`);
                if (columnElement) {
                    const cardsContainer = columnElement.querySelector('.kanban-cards');
                    if (cardsContainer) {
                        column.cards.forEach(card => {
                            const cardElement = createCardElement(card);
                            cardsContainer.appendChild(cardElement);
                        });
                    }
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—ã –∫–æ–ª–æ–Ω–æ–∫
            updateColumnSums();
            updateColumnCounts();
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–±–∞–Ω–∞:', error);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
            console.log('–ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ...');
            loadTestData();
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    function loadTestData() {
        const testData = {
            columns: [
                { id: 1, title: "–ö–ë", color: "#d1fae5", cards: [] },
                { id: 2, title: "–°—Ç–æ–ª—è—Ä–Ω—ã–π —Ü–µ—Ö", color: "#fef3c7", cards: [] },
                { id: 3, title: "–§–æ—Ä–º–æ–≤–∫–∞", color: "#e0e7ff", cards: [] },
                { id: 4, title: "–®–≤–µ–π–Ω—ã–π —Ü–µ—Ö", color: "#f3e8ff", cards: [] },
                { id: 5, title: "–û–±–∏–≤–∫–∞", color: "#fde68a", cards: [] },
                { id: 6, title: "–°–±–æ—Ä–∫–∞ –∏ —É–ø–∞–∫–æ–≤–∫–∞", color: "#fce7f3", cards: [] },
                { id: 7, title: "–û—Ç–≥—Ä—É–∂–µ–Ω", color: "#e0f7f7", cards: [] }
            ]
        };
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
        const testCards = [
            {
                id: 1,
                order_number: "ORD-001",
                client: "–ê–ª–µ–∫—Å–µ–π –ß–µ—Ä–Ω–æ–≤",
                phone: "+7 (999) 123-45-67",
                email: "alexey@example.com",
                price: 42500,
                prepayment: 15000,
                product_name: "–î–∏–≤–∞–Ω '–ù–µ–∞–ø–æ–ª—å' —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞–∫–∫–æ—Ä–¥–µ–æ–Ω",
                deadline: "2023-10-15",
                priority: "high",
                notes: "–°—Ä–æ—á–Ω—ã–π –∑–∞–∫–∞–∑",
                status: 1,
                color: "#ffffff",
                created_at: "2023-09-10T10:00:00Z",
                stage_started_at: "2023-09-10T10:00:00Z",
                branches: { frame: 'not_started', upholstery: 'not_started' },
                ready_for_assembly: false
            },
            {
                id: 2,
                order_number: "ORD-002", 
                client: "–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞",
                phone: "+7 (999) 234-56-78",
                email: "maria@example.com",
                price: 28700,
                prepayment: 10000,
                product_name: "–ö—Ä–µ—Å–ª–æ '–ú–µ–ª–∏—Å—Å–∞' —Å –ø–æ–¥–≥–æ–ª–æ–≤–Ω–∏–∫–æ–º",
                deadline: "2023-10-20",
                priority: "medium",
                notes: "–û–±—ã—á–Ω—ã–π –∑–∞–∫–∞–∑",
                status: 2,
                color: "#ffffff",
                created_at: "2023-09-12T14:30:00Z",
                stage_started_at: "2023-09-12T14:30:00Z",
                branches: { frame: 'in_progress', upholstery: 'not_started' },
                ready_for_assembly: false
            },
            {
                id: 3,
                order_number: "ORD-003",
                client: "–ï–ª–µ–Ω–∞ –õ—å–≤–æ–≤–∞", 
                phone: "+7 (999) 345-67-89",
                email: "elena@example.com",
                price: 38900,
                prepayment: 15000,
                product_name: "–°–ø–∞–ª—å–Ω—ã–π –≥–∞—Ä–Ω–∏—Ç—É—Ä '–ê—Ñ–∏–Ω–∞' —Å –∑–µ—Ä–∫–∞–ª–æ–º",
                deadline: "2023-10-25",
                priority: "low",
                notes: "–ó–∞–∫–∞–∑ –≥–æ—Ç–æ–≤ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ",
                status: 7,
                color: "#ffffff",
                created_at: "2023-09-01T09:15:00Z",
                stage_started_at: "2023-09-01T09:15:00Z",
                branches: { frame: 'completed', upholstery: 'completed' },
                ready_for_assembly: true
            }
        ];
        
        // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
        testCards.forEach(card => {
            const column = testData.columns.find(col => col.id === card.status);
            if (column) {
                column.cards.push(card);
            }
        });
        
        // –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
        document.querySelectorAll('.kanban-cards').forEach(container => {
            container.innerHTML = '';
        });
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–æ–ª–æ–Ω–∫–∏ –¥–∞–Ω–Ω—ã–º–∏
        testData.columns.forEach(column => {
            const columnElement = document.querySelector(`[data-column-id="${column.id}"]`);
            if (columnElement) {
                const cardsContainer = columnElement.querySelector('.kanban-cards');
                if (cardsContainer) {
                    column.cards.forEach(card => {
                        const cardElement = createCardElement(card);
                        cardsContainer.appendChild(cardElement);
                    });
                }
            }
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—ã –∫–æ–ª–æ–Ω–æ–∫
        updateColumnSums();
        updateColumnCounts();
        
        console.log('–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
    function createCardElement(card) {
        const cardElement = document.createElement('div');
        cardElement.className = 'kanban-card';
        cardElement.draggable = true;
        cardElement.setAttribute('data-card-id', card.id);
        cardElement.setAttribute('data-card-amount', card.price);
        cardElement.onclick = () => openDetailPanel(cardElement);
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≤–µ—Ç–æ–∫
        const branches = card.branches || { frame: 'not_started', upholstery: 'not_started' };
        
        cardElement.innerHTML = `
            <div class="card-header">
                <div class="card-amount">${card.price.toLocaleString('ru-RU')} ‚ÇΩ</div>
                <div class="card-priority priority-${card.priority || 'medium'}">${getPriorityText(card.priority)}</div>
            </div>
            <h3 class="card-title">${card.product_name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
            <div class="card-dates">
                <span>–°–æ–∑–¥–∞–Ω: ${new Date(card.created_at).toLocaleDateString('ru-RU')}</span>
                <span class="prepayment">–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞: ${(card.prepayment || 0).toLocaleString('ru-RU')} ‚ÇΩ</span>
            </div>
            
            <!-- –í–µ—Ç–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ -->
            <div class="card-branches">
                <div class="branch-item">
                    <div class="branch-icon branch-frame">üî®</div>
                    <span class="branch-label">–ö–∞—Ä–∫–∞—Å:</span>
                    <span class="branch-status status-${branches.frame === 'not_started' ? 'not-started' : branches.frame === 'in_progress' ? 'in-progress' : 'completed'}">${getBranchStatusText(branches.frame)}</span>
                </div>
                <div class="branch-item">
                    <div class="branch-icon branch-upholstery">üßµ</div>
                    <span class="branch-label">–û–±–∏–≤–∫–∞:</span>
                    <span class="branch-status status-${branches.upholstery === 'not_started' ? 'not-started' : branches.upholstery === 'in_progress' ? 'in-progress' : 'completed'}">${getBranchStatusText(branches.upholstery)}</span>
                </div>
            </div>
            
            <div class="card-footer">
                <div class="client-avatar">${getClientInitials(card.client)}</div>
                <div class="client-name">${card.client || '–ù–µ —É–∫–∞–∑–∞–Ω'}</div>
            </div>
        `;
        
        return cardElement;
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function getPriorityText(priority) {
        switch (priority) {
            case 'high': return '–í—ã—Å–æ–∫–∏–π';
            case 'medium': return '–°—Ä–µ–¥–Ω–∏–π';
            case 'low': return '–ù–∏–∑–∫–∏–π';
            default: return '–°—Ä–µ–¥–Ω–∏–π';
        }
    }
    
    function getBranchStatusText(status) {
        switch (status) {
            case 'not_started': return '–ù–µ –Ω–∞—á–∞—Ç';
            case 'in_progress': return '–í —Ä–∞–±–æ—Ç–µ';
            case 'completed': return '–ì–æ—Ç–æ–≤';
            default: return '–ù–µ –Ω–∞—á–∞—Ç';
        }
    }
    
    function getClientInitials(name) {
        if (!name) return '–ù–ö';
        return name.split(' ').map(word => word[0]).join('').toUpperCase().slice(0, 2);
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', function() {
        const savedTheme = localStorage.getItem('theme');
        const themeText = themeToggle.querySelector('span');
        
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-theme');
            themeText.textContent = '–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
        } else {
            themeText.textContent = '–¢–µ–º–Ω–∞—è —Ç–µ–º–∞';
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–Ω–±–∞–Ω–∞
        loadKanbanData();
    });
    </script>
</body>
</html>