-- Добавление демо-сотрудников в систему

-- Сначала добавим отделы, если их нет
INSERT INTO departments (name, description) VALUES 
('Производство', 'Отдел производства мебели'),
('Менеджмент', 'Управленческий персонал'),
('Снабжение', 'Отдел закупок и снабжения'),
('Бухгалтерия', 'Финансовый отдел'),
('Дизайн', 'Отдел дизайна и проектирования')
ON CONFLICT (name) DO NOTHING;

-- Добавим должности
INSERT INTO positions (name, department_id, salary_min, salary_max) VALUES 
('Мастер цеха', 1, 80000, 120000),
('Столяр', 1, 60000, 90000),
('Швея', 1, 50000, 80000),
('Сборщик', 1, 55000, 85000),
('Директор', 2, 150000, 250000),
('Менеджер по продажам', 2, 70000, 120000),
('Менеджер по закупкам', 3, 65000, 110000),
('Бухгалтер', 4, 60000, 100000),
('Дизайнер', 5, 70000, 130000),
('Технолог', 1, 75000, 115000)
ON CONFLICT (name) DO NOTHING;

-- Добавим демо-сотрудников
INSERT INTO employees (
    first_name, 
    last_name, 
    middle_name, 
    email, 
    phone, 
    position, 
    department_id, 
    hire_date, 
    salary, 
    status,
    address,
    birth_date,
    passport_series,
    passport_number,
    passport_issued_by,
    passport_issued_date,
    snils,
    inn
) VALUES 
-- Производство
('Александр', 'Петров', 'Владимирович', 'petrov.av@sofany.com', '+7-999-111-22-33', 'Мастер цеха', 1, '2020-03-15', 95000, 'active', 'г. Москва, ул. Промышленная, д. 15, кв. 45', '1985-06-12', '4510', '123456', 'ОУФМС России по г. Москве', '2010-05-20', '123-456-789-01', '123456789012'),
('Михаил', 'Сидоров', 'Александрович', 'sidorov.ma@sofany.com', '+7-999-222-33-44', 'Столяр', 1, '2021-07-20', 75000, 'active', 'г. Москва, ул. Лесная, д. 8, кв. 12', '1990-09-25', '4511', '234567', 'ОУФМС России по г. Москве', '2012-08-15', '234-567-890-12', '234567890123'),
('Елена', 'Козлова', 'Сергеевна', 'kozlova.es@sofany.com', '+7-999-333-44-55', 'Швея', 1, '2019-11-10', 65000, 'active', 'г. Москва, ул. Текстильная, д. 22, кв. 78', '1988-12-03', '4512', '345678', 'ОУФМС России по г. Москве', '2011-03-10', '345-678-901-23', '345678901234'),
('Дмитрий', 'Волков', 'Игоревич', 'volkov.di@sofany.com', '+7-999-444-55-66', 'Сборщик', 1, '2022-01-15', 70000, 'active', 'г. Москва, ул. Сборная, д. 5, кв. 33', '1992-04-18', '4513', '456789', 'ОУФМС России по г. Москве', '2013-07-22', '456-789-012-34', '456789012345'),
('Анна', 'Морозова', 'Дмитриевна', 'morozova.ad@sofany.com', '+7-999-555-66-77', 'Технолог', 1, '2020-09-01', 85000, 'active', 'г. Москва, ул. Техническая, д. 17, кв. 56', '1987-08-14', '4514', '567890', 'ОУФМС России по г. Москве', '2014-11-05', '567-890-123-45', '567890123456'),

-- Менеджмент
('Владимир', 'Иванов', 'Петрович', 'ivanov.vp@sofany.com', '+7-999-666-77-88', 'Директор', 2, '2018-01-10', 200000, 'active', 'г. Москва, ул. Центральная, д. 1, кв. 100', '1975-03-22', '4505', '678901', 'ОУФМС России по г. Москве', '2005-12-15', '678-901-234-56', '678901234567'),
('Ольга', 'Смирнова', 'Александровна', 'smirnova.oa@sofany.com', '+7-999-777-88-99', 'Менеджер по продажам', 2, '2021-02-20', 90000, 'active', 'г. Москва, ул. Торговая, д. 25, кв. 89', '1989-11-08', '4515', '789012', 'ОУФМС России по г. Москве', '2015-04-18', '789-012-345-67', '789012345678'),

-- Снабжение
('Сергей', 'Кузнецов', 'Владимирович', 'kuznetsov.sv@sofany.com', '+7-999-888-99-00', 'Менеджер по закупкам', 3, '2020-05-12', 80000, 'active', 'г. Москва, ул. Закупочная, д. 12, кв. 44', '1983-07-30', '4516', '890123', 'ОУФМС России по г. Москве', '2016-09-12', '890-123-456-78', '890123456789'),

-- Бухгалтерия
('Татьяна', 'Новикова', 'Сергеевна', 'novikova.ts@sofany.com', '+7-999-999-00-11', 'Бухгалтер', 4, '2019-08-05', 75000, 'active', 'г. Москва, ул. Финансовая, д. 30, кв. 67', '1986-01-15', '4517', '901234', 'ОУФМС России по г. Москве', '2017-02-28', '901-234-567-89', '901234567890'),

-- Дизайн
('Мария', 'Федорова', 'Андреевна', 'fedorova.ma@sofany.com', '+7-999-000-11-22', 'Дизайнер', 5, '2021-04-03', 95000, 'active', 'г. Москва, ул. Креативная, д. 7, кв. 23', '1991-10-27', '4518', '012345', 'ОУФМС России по г. Москве', '2018-06-14', '012-345-678-90', '012345678901');

-- Обновим статистику
UPDATE departments SET 
    employee_count = (SELECT COUNT(*) FROM employees WHERE department_id = departments.id AND status = 'active'),
    updated_at = CURRENT_TIMESTAMP;

UPDATE positions SET 
    employee_count = (SELECT COUNT(*) FROM employees WHERE position = positions.name AND status = 'active'),
    updated_at = CURRENT_TIMESTAMP;

-- Сначала добавим отделы, если их нет
INSERT INTO departments (name, description) VALUES 
('Производство', 'Отдел производства мебели'),
('Менеджмент', 'Управленческий персонал'),
('Снабжение', 'Отдел закупок и снабжения'),
('Бухгалтерия', 'Финансовый отдел'),
('Дизайн', 'Отдел дизайна и проектирования')
ON CONFLICT (name) DO NOTHING;

-- Добавим должности
INSERT INTO positions (name, department_id, salary_min, salary_max) VALUES 
('Мастер цеха', 1, 80000, 120000),
('Столяр', 1, 60000, 90000),
('Швея', 1, 50000, 80000),
('Сборщик', 1, 55000, 85000),
('Директор', 2, 150000, 250000),
('Менеджер по продажам', 2, 70000, 120000),
('Менеджер по закупкам', 3, 65000, 110000),
('Бухгалтер', 4, 60000, 100000),
('Дизайнер', 5, 70000, 130000),
('Технолог', 1, 75000, 115000)
ON CONFLICT (name) DO NOTHING;

-- Добавим демо-сотрудников
INSERT INTO employees (
    first_name, 
    last_name, 
    middle_name, 
    email, 
    phone, 
    position, 
    department_id, 
    hire_date, 
    salary, 
    status,
    address,
    birth_date,
    passport_series,
    passport_number,
    passport_issued_by,
    passport_issued_date,
    snils,
    inn
) VALUES 
-- Производство
('Александр', 'Петров', 'Владимирович', 'petrov.av@sofany.com', '+7-999-111-22-33', 'Мастер цеха', 1, '2020-03-15', 95000, 'active', 'г. Москва, ул. Промышленная, д. 15, кв. 45', '1985-06-12', '4510', '123456', 'ОУФМС России по г. Москве', '2010-05-20', '123-456-789-01', '123456789012'),
('Михаил', 'Сидоров', 'Александрович', 'sidorov.ma@sofany.com', '+7-999-222-33-44', 'Столяр', 1, '2021-07-20', 75000, 'active', 'г. Москва, ул. Лесная, д. 8, кв. 12', '1990-09-25', '4511', '234567', 'ОУФМС России по г. Москве', '2012-08-15', '234-567-890-12', '234567890123'),
('Елена', 'Козлова', 'Сергеевна', 'kozlova.es@sofany.com', '+7-999-333-44-55', 'Швея', 1, '2019-11-10', 65000, 'active', 'г. Москва, ул. Текстильная, д. 22, кв. 78', '1988-12-03', '4512', '345678', 'ОУФМС России по г. Москве', '2011-03-10', '345-678-901-23', '345678901234'),
('Дмитрий', 'Волков', 'Игоревич', 'volkov.di@sofany.com', '+7-999-444-55-66', 'Сборщик', 1, '2022-01-15', 70000, 'active', 'г. Москва, ул. Сборная, д. 5, кв. 33', '1992-04-18', '4513', '456789', 'ОУФМС России по г. Москве', '2013-07-22', '456-789-012-34', '456789012345'),
('Анна', 'Морозова', 'Дмитриевна', 'morozova.ad@sofany.com', '+7-999-555-66-77', 'Технолог', 1, '2020-09-01', 85000, 'active', 'г. Москва, ул. Техническая, д. 17, кв. 56', '1987-08-14', '4514', '567890', 'ОУФМС России по г. Москве', '2014-11-05', '567-890-123-45', '567890123456'),

-- Менеджмент
('Владимир', 'Иванов', 'Петрович', 'ivanov.vp@sofany.com', '+7-999-666-77-88', 'Директор', 2, '2018-01-10', 200000, 'active', 'г. Москва, ул. Центральная, д. 1, кв. 100', '1975-03-22', '4505', '678901', 'ОУФМС России по г. Москве', '2005-12-15', '678-901-234-56', '678901234567'),
('Ольга', 'Смирнова', 'Александровна', 'smirnova.oa@sofany.com', '+7-999-777-88-99', 'Менеджер по продажам', 2, '2021-02-20', 90000, 'active', 'г. Москва, ул. Торговая, д. 25, кв. 89', '1989-11-08', '4515', '789012', 'ОУФМС России по г. Москве', '2015-04-18', '789-012-345-67', '789012345678'),

-- Снабжение
('Сергей', 'Кузнецов', 'Владимирович', 'kuznetsov.sv@sofany.com', '+7-999-888-99-00', 'Менеджер по закупкам', 3, '2020-05-12', 80000, 'active', 'г. Москва, ул. Закупочная, д. 12, кв. 44', '1983-07-30', '4516', '890123', 'ОУФМС России по г. Москве', '2016-09-12', '890-123-456-78', '890123456789'),

-- Бухгалтерия
('Татьяна', 'Новикова', 'Сергеевна', 'novikova.ts@sofany.com', '+7-999-999-00-11', 'Бухгалтер', 4, '2019-08-05', 75000, 'active', 'г. Москва, ул. Финансовая, д. 30, кв. 67', '1986-01-15', '4517', '901234', 'ОУФМС России по г. Москве', '2017-02-28', '901-234-567-89', '901234567890'),

-- Дизайн
('Мария', 'Федорова', 'Андреевна', 'fedorova.ma@sofany.com', '+7-999-000-11-22', 'Дизайнер', 5, '2021-04-03', 95000, 'active', 'г. Москва, ул. Креативная, д. 7, кв. 23', '1991-10-27', '4518', '012345', 'ОУФМС России по г. Москве', '2018-06-14', '012-345-678-90', '012345678901');

-- Обновим статистику
UPDATE departments SET 
    employee_count = (SELECT COUNT(*) FROM employees WHERE department_id = departments.id AND status = 'active'),
    updated_at = CURRENT_TIMESTAMP;

UPDATE positions SET 
    employee_count = (SELECT COUNT(*) FROM employees WHERE position = positions.name AND status = 'active'),
    updated_at = CURRENT_TIMESTAMP;










