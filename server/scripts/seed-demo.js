const db = require('../config/database');

const seedDemoData = async () => {
  try {
    console.log('üå± –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–µ–º–æ-–∑–∞–∫–∞–∑–∞–º–∏...');

    const customers = await db.query("SELECT id, name FROM customers");
    if (customers.rows.length < 5) {
      throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –æ—Å–Ω–æ–≤–Ω–æ–π `seed` —Å–∫—Ä–∏–ø—Ç.');
    }
    const users = await db.query("SELECT id FROM users");
    if (users.rows.length < 2) {
      throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –æ—Å–Ω–æ–≤–Ω–æ–π `seed` —Å–∫—Ä–∏–ø—Ç.');
    }
    
    const customerMap = new Map(customers.rows.map(c => [c.id, c.name]));
    const userIds = users.rows.map(u => u.id);

    const ordersData = [
      { order_number: 'SOF-0001', customer_id: customers.rows[0].id, status: 'in_production', priority: 'high', total_amount: 125000, paid_amount: 60000, delivery_date: '2025-10-15', created_by: userIds[0], product_name: '–£–≥–ª–æ–≤–æ–π –¥–∏–≤–∞–Ω "–ê—Ç–ª–∞–Ω—Ç"', product_desc: '–ì–∞–±–∞—Ä–∏—Ç—ã 280—Ö160 —Å–º. –í–µ–ª—é—Ä "Enigma 15" (—Ç–µ–º–Ω–æ-—Å–µ—Ä—ã–π), –º–µ—Ö–∞–Ω–∏–∑–º "–î–µ–ª—å—Ñ–∏–Ω". –ü–æ–¥—É—à–∫–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ.', notes: '–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏—Ç —É—Å–∫–æ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É. –ì–æ—Ç–æ–≤ –¥–æ–ø–ª–∞—Ç–∏—Ç—å. –°–≤—è–∑–∞—Ç—å—Å—è 10.10.2025.', production_stage: '–°—Ç–æ–ª—è—Ä–Ω—ã–π —Ü–µ—Ö', materials_cost: 45000, labor_cost: 25000, project_description: '–ë–æ–ª—å—à–æ–π —É–≥–ª–æ–≤–æ–π –¥–∏–≤–∞–Ω –¥–ª—è –≥–æ—Å—Ç–∏–Ω–æ–π. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.', delivery_address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, –¥. 10, –∫–≤. 5', has_elevator: true, floor: '3', delivery_notes: '–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∑–∞ —á–∞—Å –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏.' },
      { order_number: 'SOF-0002', customer_id: customers.rows[1].id, status: 'in_production', priority: 'medium', total_amount: 48000, paid_amount: 20000, delivery_date: '2025-10-20', created_by: userIds[1], product_name: '–ö—Ä–µ—Å–ª–æ-–∫—Ä–æ–≤–∞—Ç—å "–õ–∞–≥—É–Ω–∞"', product_desc: '–†–æ–≥–æ–∂–∫–∞ "Malmo 23" (–±–µ–∂–µ–≤—ã–π), –≤—ã–∫–∞—Ç–Ω–æ–π –º–µ—Ö–∞–Ω–∏–∑–º. –®–∏—Ä–∏–Ω–∞ —Å–ø–∞–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞ 90 —Å–º.', notes: '–ó–≤–æ–Ω–æ–∫ –æ—Ç 05.09: –∫–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏–ª —É—Ç–æ—á–Ω–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —à–∏—Ä–∏–Ω—ã –ø–æ–¥–ª–æ–∫–æ—Ç–Ω–∏–∫–æ–≤ –¥–æ 15 —Å–º. –ñ–¥–µ–º —á–µ—Ä—Ç–µ–∂ –æ—Ç –ö–ë.', production_stage: '–ö–ë', materials_cost: 18000, labor_cost: 12000, project_description: '–ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ –∫—Ä–µ—Å–ª–æ-–∫—Ä–æ–≤–∞—Ç—å –¥–ª—è –¥–µ—Ç—Å–∫–æ–π –∫–æ–º–Ω–∞—Ç—ã. –û–±–∏–≤–∫–∞ –ª–µ–≥–∫–æ —á–∏—Å—Ç–∏—Ç—Å—è.', delivery_address: '–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ù–µ–≤—Å–∫–∏–π –ø—Ä-—Ç, –¥. 25, –∫–≤. 12', has_elevator: false, floor: '4', delivery_notes: '–ü–æ–¥—ä–µ–º –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ, —Ç—Ä–µ–±—É–µ—Ç—Å—è 2 –≥—Ä—É–∑—á–∏–∫–∞.' },
      { order_number: 'SOF-0003', customer_id: customers.rows[2].id, status: 'in_production', priority: 'high', total_amount: 210000, paid_amount: 100000, delivery_date: '2025-11-01', created_by: userIds[0], product_name: '–ú–æ–¥—É–ª—å–Ω—ã–π –¥–∏–≤–∞–Ω "–û—Ä–∏–æ–Ω"', product_desc: '–≠–∫–æ-–∫–æ–∂–∞ "Terra 115" (–∫–æ—Ä–∏—á–Ω–µ–≤–∞—è), 5 –º–æ–¥—É–ª–µ–π.', notes: '–ó–∞–∫–∞–∑ –æ—Ç –¥–∏–∑–∞–π–Ω-—Å—Ç—É–¥–∏–∏. –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ —à–≤–æ–≤.', production_stage: '–§–æ—Ä–º–æ–≤–∫–∞', materials_cost: 80000, labor_cost: 50000, project_description: '–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å–Ω—ã–π –¥–∏–≤–∞–Ω –¥–ª—è –∑–∞–≥–æ—Ä–æ–¥–Ω–æ–≥–æ –¥–æ–º–∞. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ 5 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π.', delivery_address: '–≥. –°–æ—á–∏, —É–ª. –ú–æ—Ä—Å–∫–∞—è, –¥. 1', has_elevator: true, floor: '1', delivery_notes: '–î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ –≤–æ—Ä–æ—Ç. –ü—Ä–æ–Ω–æ—Å –ø–æ —É—á–∞—Å—Ç–∫—É —Å–∏–ª–∞–º–∏ –∑–∞–∫–∞–∑—á–∏–∫–∞.' },
      { order_number: 'SOF-0004', customer_id: customers.rows[3].id, status: 'in_production', priority: 'low', total_amount: 15000, paid_amount: 7000, delivery_date: '2025-09-30', created_by: userIds[1], product_name: '–ü—É—Ñ "–í–µ–ª—é—Ä"', product_desc: '–ë–∞—Ä—Ö–∞—Ç "Velvet Lux 24" (–∏–∑—É–º—Ä—É–¥–Ω—ã–π), —Å —è—â–∏–∫–æ–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è.', notes: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∏–∑–¥–µ–ª–∏–µ, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.', production_stage: '–®–≤–µ–π–Ω—ã–π —Ü–µ—Ö', materials_cost: 5000, labor_cost: 4000, project_description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π –ø—É—Ñ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —è—â–∏–∫–æ–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è. –ù–æ–∂–∫–∏ –∏–∑ –º–∞—Å—Å–∏–≤–∞ –±—É–∫–∞.', delivery_address: '–≥. –ö–∞–∑–∞–Ω—å, —É–ª. –ë–∞—É–º–∞–Ω–∞, –¥. 50, –∫–≤. 8', has_elevator: true, floor: '2', delivery_notes: '' },
      { order_number: 'SOF-0005', customer_id: customers.rows[4].id, status: 'in_production', priority: 'medium', total_amount: 55000, paid_amount: 25000, delivery_date: '2025-10-25', created_by: userIds[0], product_name: '–î–∏–≤–∞–Ω-–∫–Ω–∏–∂–∫–∞ "–ö–ª–∞—Å—Å–∏–∫–∞"', product_desc: '–ñ–∞–∫–∫–∞—Ä–¥ "Versal 03", –º–µ—Ö–∞–Ω–∏–∑–º "–∫–ª–∏–∫-–∫–ª—è–∫".', notes: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –º–µ—Ö–∞–Ω–∏–∑–º–∞ "–∫–ª–∏–∫-–∫–ª—è–∫" –ø–µ—Ä–µ–¥ –æ—Ç–≥—Ä—É–∑–∫–æ–π.', production_stage: '–®–≤–µ–π–Ω—ã–π —Ü–µ—Ö', materials_cost: 22000, labor_cost: 15000, project_description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –¥–∏–≤–∞–Ω–∞-–∫–Ω–∏–∂–∫–∏ —Å —è—â–∏–∫–æ–º –¥–ª—è –±–µ–ª—å—è. –î–µ—Ä–µ–≤—è–Ω–Ω—ã–µ –Ω–æ–∂–∫–∏ —Ü–≤–µ—Ç–∞ "–≤–µ–Ω–≥–µ".', delivery_address: '–≥. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, —É–ª. –ú–∞–ª—ã—à–µ–≤–∞, –¥. 70, –∫–≤. 34', has_elevator: false, floor: '5', delivery_notes: '–°—Ç–∞—Ä—ã–π –¥–∏–≤–∞–Ω –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤—ã–Ω–µ—Å—Ç–∏. –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –≥—Ä—É–∑—á–∏–∫–æ–≤.' },
      { order_number: 'SOF-0006', customer_id: customers.rows[0].id, status: 'in_production', priority: 'medium', total_amount: 32000, paid_amount: 15000, delivery_date: '2025-10-10', created_by: userIds[1], product_name: '–ö—Ä–µ—Å–ª–æ "–≠–≥–æ"', product_desc: '–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –∫–æ–∂–∞ "Dakota", —Ü–≤–µ—Ç "–ö–æ–Ω—å—è–∫", –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º.', notes: '–ö–æ–∂–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –≤—ã–¥–µ–ª–∫–∏, –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ.', production_stage: '–û–±–∏–≤–∫–∞', materials_cost: 15000, labor_cost: 10000, project_description: '–£—é—Ç–Ω–æ–µ –∫—Ä–µ—Å–ª–æ –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞ —Å –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º. –ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –∫–æ–∂–∞.', delivery_address: '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, –¥. 10, –∫–≤. 5', has_elevator: true, floor: '3', delivery_notes: '–î–æ—Å—Ç–∞–≤–∏—Ç—å –≤–º–µ—Å—Ç–µ —Å –∑–∞–∫–∞–∑–æ–º SOF-720101.' },
      { order_number: 'SOF-0007', customer_id: customers.rows[1].id, status: 'in_production', priority: 'high', total_amount: 72000, paid_amount: 35000, delivery_date: '2025-11-05', created_by: userIds[0], product_name: '–°–æ—Ñ–∞ "–≠–ª–µ–≥–∞–Ω—Ç"', product_desc: '–®–µ–Ω–∏–ª–ª "Verona 12", –º–µ—Ö–∞–Ω–∏–∑–º "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è —Ä–∞—Å–∫–ª–∞–¥—É—à–∫–∞".', notes: '–°—Ä–æ—á–Ω—ã–π –∑–∞–∫–∞–∑ –¥–ª—è —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏. –î–æ—Å—Ç–∞–≤–∫–∞ —Å—Ç—Ä–æ–≥–æ –¥–æ 12:00.', production_stage: '–°–±–æ—Ä–∫–∞ –∏ —É–ø–∞–∫–æ–≤–∫–∞', materials_cost: 30000, labor_cost: 20000, project_description: '–ù–µ–±–æ–ª—å—à–∞—è —Å–æ—Ñ–∞ –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º —Å—Ç–∏–ª–µ. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤.', delivery_address: '–≥. –ú–æ—Å–∫–≤–∞, –§–æ—Ç–æ—Å—Ç—É–¥–∏—è "–õ–æ—Ñ—Ç", –ë–µ—Ä—Å–µ–Ω–µ–≤—Å–∫–∞—è –Ω–∞–±., 6', has_elevator: true, floor: '2', delivery_notes: '–°—Ç—Ä–æ–≥–æ –¥–æ 12:00. –ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ - –ú–∞—Ä–∏—è.' },
      { order_number: 'SOF-0008', customer_id: customers.rows[2].id, status: 'in_production', priority: 'low', total_amount: 22000, paid_amount: 10000, delivery_date: '2025-10-01', created_by: userIds[1], product_name: '–ë–∞–Ω–∫–µ—Ç–∫–∞ "–†–µ–Ω–µ—Å—Å–∞–Ω—Å"', product_desc: '–ö–∞—Ä–µ—Ç–Ω–∞—è —Å—Ç—è–∂–∫–∞, –≤–µ–ª—é—Ä "Amelia 05", –º–∞—Å—Å–∏–≤ –¥—É–±–∞, —Ü–≤–µ—Ç "–í–µ–Ω–≥–µ".', notes: '–ù–æ–∂–∫–∏ –ø–æ–∫—Ä—ã—Ç—å –º–∞—Ç–æ–≤—ã–º –ª–∞–∫–æ–º.', production_stage: '–°–±–æ—Ä–∫–∞ –∏ —É–ø–∞–∫–æ–≤–∫–∞', materials_cost: 9000, labor_cost: 7000, project_description: '–ë–∞–Ω–∫–µ—Ç–∫–∞ –¥–ª—è –ø—Ä–∏—Ö–æ–∂–µ–π —Å –∫–∞—Ä–µ—Ç–Ω–æ–π —Å—Ç—è–∂–∫–æ–π. –†—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞.', delivery_address: '–≥. –°–æ—á–∏, —É–ª. –ú–æ—Ä—Å–∫–∞—è, –¥. 1', has_elevator: true, floor: '1', delivery_notes: '–î–æ—Å—Ç–∞–≤–∏—Ç—å –≤–º–µ—Å—Ç–µ —Å –∑–∞–∫–∞–∑–æ–º SOF-720103.' },
      { order_number: 'SOF-0009', customer_id: customers.rows[3].id, status: 'shipped', priority: 'medium', total_amount: 41000, paid_amount: 41000, delivery_date: '2025-10-18', created_by: userIds[0], product_name: '–î–µ—Ç—Å–∫–∏–π –¥–∏–≤–∞–Ω "–ú–∞–ª—é—Ç–∫–∞"', product_desc: '–ú–∏–∫—Ä–æ—Ñ–∏–±—Ä–∞ "Happy kids", –º–µ—Ö–∞–Ω–∏–∑–º "–∞–∫–∫–æ—Ä–¥–µ–æ–Ω".', notes: '–ó–∞–∫–∞–∑ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–ª–∞—á–µ–Ω. –î–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞ –Ω–∞ –≤–µ—á–µ—Ä.', production_stage: '–û—Ç–≥—Ä—É–∂–µ–Ω', materials_cost: 17000, labor_cost: 11000, project_description: '–Ø—Ä–∫–∏–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–∏–≤–∞–Ω –¥–ª—è –¥–µ—Ç—Å–∫–æ–π. –ì–∏–ø–æ–∞–ª–ª–µ—Ä–≥–µ–Ω–Ω—ã–π –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å.', delivery_address: '–≥. –ö–∞–∑–∞–Ω—å, —É–ª. –ë–∞—É–º–∞–Ω–∞, –¥. 50, –∫–≤. 8', has_elevator: true, floor: '2', delivery_notes: '–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ—Å–ª–µ 19:00.' },
      { order_number: 'SOF-0010', customer_id: customers.rows[4].id, status: 'shipped', priority: 'high', total_amount: 89000, paid_amount: 89000, delivery_date: '2025-10-12', created_by: userIds[1], product_name: '–û—Ñ–∏—Å–Ω—ã–π –¥–∏–≤–∞–Ω "–°—Ç–∞—Ç—É—Å"', product_desc: '–ß–µ—Ä–Ω–∞—è —ç–∫–æ-–∫–æ–∂–∞ "Oregon", —Ö—Ä–æ–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–æ–∂–∫–∏, 3-—Ö –º–µ—Å—Ç–Ω—ã–π.', notes: '–ó–∞–∫–∞–∑ –¥–ª—è –æ—Ñ–∏—Å–∞ –ì–∞–∑–ø—Ä–æ–º. –¢—Ä–µ–±—É—é—Ç—Å—è –≤—Å–µ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã.', production_stage: '–û—Ç–≥—Ä—É–∂–µ–Ω', materials_cost: 35000, labor_cost: 25000, project_description: '–°—Ç—Ä–æ–≥–∏–π –∏ —Å—Ç–∏–ª—å–Ω—ã–π –¥–∏–≤–∞–Ω –¥–ª—è –ø—Ä–∏–µ–º–Ω–æ–π. –†–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ –≤—ã—Å–æ–∫—É—é –Ω–∞–≥—Ä—É–∑–∫—É.', delivery_address: '–≥. –ú–æ—Å–∫–≤–∞, –ë–∏–∑–Ω–µ—Å-–¶–µ–Ω—Ç—Ä "–ú–æ—Å–∫–≤–∞-–°–∏—Ç–∏", –ë–∞—à–Ω—è –§–µ–¥–µ—Ä–∞—Ü–∏—è', has_elevator: true, floor: '45', delivery_notes: '–¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–ø—É—Å–∫. –ó–∞–∫–∞–∑–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ.' },
      { order_number: 'SOF-0011', customer_id: customers.rows[0].id, status: 'new', priority: 'medium', total_amount: 67000, paid_amount: 30000, delivery_date: '2025-11-15', created_by: userIds[0], product_name: '–î–∏–≤–∞–Ω "–ú–æ–Ω–∞–∫–æ"', product_desc: '–¢–∫–∞–Ω—å –≤–µ–ª—é—Ä "Monolit 37", –∑–µ–ª–µ–Ω—ã–π. –ú–µ—Ö–∞–Ω–∏–∑–º "–ï–≤—Ä–æ–∫–Ω–∏–∂–∫–∞".', notes: '–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏—Ç —Å–¥–µ–ª–∞—Ç—å –ø–æ–¥—É—à–∫–∏ –≤ —Ç–æ–π –∂–µ —Ç–∫–∞–Ω–∏. –£—Ç–æ—á–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä—ã –ø–æ–¥—É—à–µ–∫.', production_stage: '–ù–æ–≤—ã–π', materials_cost: 28000, labor_cost: 18000, project_description: '–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–≤–∞–Ω –≤ —Å–∫–∞–Ω–¥–∏–Ω–∞–≤—Å–∫–æ–º —Å—Ç–∏–ª–µ. –Ø—Ä–∫–∏–π –∞–∫—Ü–µ–Ω—Ç –¥–ª—è –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞.', delivery_address: '–≥. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, —É–ª. –ö—Ä–∞—Å–Ω—ã–π –ø—Ä–æ—Å–ø–µ–∫—Ç, –¥. 100, –∫–≤. 20', has_elevator: true, floor: '7', delivery_notes: '–ö–æ–¥ –¥–æ–º–æ—Ñ–æ–Ω–∞ 2021.' },
      { order_number: 'SOF-0012', customer_id: customers.rows[1].id, status: 'completed', priority: 'low', total_amount: 18000, paid_amount: 18000, delivery_date: '2025-09-25', created_by: userIds[1], product_name: '–ö—Ä–µ—Å–ª–æ-–º–µ—à–æ–∫ "–ì—Ä—É—à–∞"', product_desc: '–¢–∫–∞–Ω—å "–û–∫—Å—Ñ–æ—Ä–¥", —Ü–≤–µ—Ç —Å–∏–Ω–∏–π. –ù–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å - –≥—Ä–∞–Ω—É–ª—ã.', notes: '–î–æ—Å—Ç–∞–≤–∫–∞ —Å–∞–º–æ–≤—ã–≤–æ–∑–æ–º. –ö–ª–∏–µ–Ω—Ç –∑–∞–±–µ—Ä–µ—Ç –≤ —Å—É–±–±–æ—Ç—É.', production_stage: '–í—ã–ø–æ–ª–Ω–µ–Ω', materials_cost: 7000, labor_cost: 5000, project_description: '–£–¥–æ–±–Ω–æ–µ –∏ –ª–µ–≥–∫–æ–µ –∫—Ä–µ—Å–ª–æ-–º–µ—à–æ–∫ –¥–ª—è –∑–æ–Ω—ã –æ—Ç–¥—ã—Ö–∞.', delivery_address: '–°–∞–º–æ–≤—ã–≤–æ–∑ —Å–æ —Å–∫–ª–∞–¥–∞', has_elevator: false, floor: '1', delivery_notes: '–°–∫–ª–∞–¥ ‚Ññ3' }
    ];

    for (const order of ordersData) {
      const { product_desc, production_stage, materials_cost, labor_cost, ...orderData } = order;
      
      const res = await db.query(
        'INSERT INTO orders (order_number, customer_id, status, priority, total_amount, paid_amount, delivery_date, notes, created_by, product_name, project_description, delivery_address, has_elevator, floor, delivery_notes) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) ON CONFLICT (order_number) DO UPDATE SET status = $3, priority = $4, total_amount = $5, paid_amount = $6, delivery_date = $7, notes = $8, updated_at = CURRENT_TIMESTAMP, product_name = $10, project_description = $11, delivery_address = $12, has_elevator = $13, floor = $14, delivery_notes = $15 RETURNING id',
        [orderData.order_number, orderData.customer_id, orderData.status, orderData.priority, orderData.total_amount, orderData.paid_amount, orderData.delivery_date, orderData.notes, orderData.created_by, orderData.product_name, orderData.project_description, orderData.delivery_address, orderData.has_elevator, orderData.floor, orderData.delivery_notes]
      );

      if (res.rows.length > 0) {
        const orderId = res.rows[0].id;

        await db.query('DELETE FROM order_items WHERE order_id = $1', [orderId]);
        await db.query(
          'INSERT INTO order_items (order_id, name, description, quantity, unit_price, total_price, materials_cost, labor_cost) VALUES ($1, $2, $3, 1, $4, $4, $5, $6)',
          [orderId, orderData.product_name, orderData.product_desc, orderData.total_amount, materials_cost, labor_cost]
        );

        await db.query('DELETE FROM production_operations WHERE order_id = $1', [orderId]);
        await db.query(
          'INSERT INTO production_operations (order_id, operation_type, production_stage, status, created_by) VALUES ($1, $2, $3, $4, $5)',
          [orderId, 'produce', production_stage, 'in_progress', orderData.created_by]
        );
        
        await db.query('DELETE FROM order_status_history WHERE order_id = $1', [orderId]);
        await db.query(
          "INSERT INTO order_status_history (order_id, status, comment, created_by) VALUES ($1, 'new', '–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏', $2)",
          [orderId, orderData.created_by]
        );
        if(order.status !== 'new') {
            await db.query(
              "INSERT INTO order_status_history (order_id, status, comment, created_by) VALUES ($1, $2, '–°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω', $3)",
              [orderId, order.status, orderData.created_by]
            );
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã
        if(order.paid_amount > 0) {
            await db.query('DELETE FROM financial_transactions WHERE order_id = $1 AND category = $2', [orderId, '–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞']);
            await db.query(
              "INSERT INTO financial_transactions (order_id, type, category, amount, description, created_by) VALUES ($1, 'income', '–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞', $2, $3, $4)",
              [orderId, order.paid_amount, `–ü—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ –ø–æ –∑–∞–∫–∞–∑—É ${order.order_number}`, order.created_by]
            );
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç—ã, –µ—Å–ª–∏ –∑–∞–∫–∞–∑ –æ–ø–ª–∞—á–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
        if(order.paid_amount > 0 && order.paid_amount === order.total_amount) {
            const finalPayment = order.total_amount - order.paid_amount;
            if (finalPayment > 0) {
              await db.query(
                "INSERT INTO financial_transactions (order_id, type, category, amount, description, created_by) VALUES ($1, 'income', '–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–ø–ª–∞—Ç–∞', $2, $3, $4)",
                [orderId, finalPayment, `–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –ø–æ –∑–∞–∫–∞–∑—É ${order.order_number}`, order.created_by]
              );
            }
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Ä–∞—Å—Ö–æ–¥–∞ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
        if(materials_cost > 0) {
            await db.query('DELETE FROM financial_transactions WHERE order_id = $1 AND category = $2', [orderId, '–ú–∞—Ç–µ—Ä–∏–∞–ª—ã']);
            await db.query(
              "INSERT INTO financial_transactions (order_id, type, category, amount, description, created_by) VALUES ($1, 'expense', '–ú–∞—Ç–µ—Ä–∏–∞–ª—ã', $2, $3, $4)",
              [orderId, materials_cost, `–ó–∞–∫—É–ø–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–ª—è –∑–∞–∫–∞–∑–∞ ${order.order_number}`, order.created_by]
            );
        }
      }
    }

    console.log('‚úÖ 12 –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–µ–º–æ-–∑–∞–∫–∞–∑–æ–≤ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã/–æ–±–Ω–æ–≤–ª–µ–Ω—ã!');

  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–º–æ-–∑–∞–∫–∞–∑–æ–≤:', error);
    throw error;
  }
};

const runSeed = async () => {
  try {
    await seedDemoData();
    process.exit(0);
  } catch (error) {
    process.exit(1);
  }
};

if (require.main === module) {
  runSeed();
}
