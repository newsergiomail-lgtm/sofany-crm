@echo off
echo ðŸš€ Ð—Ð°Ð¿ÑƒÑÐº SofanyCRM ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹...
echo ================================

REM Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð² Ð¿Ñ€Ð¸ Ð²Ñ‹Ñ…Ð¾Ð´Ðµ
:cleanup
echo.
echo ðŸ›‘ ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹...
taskkill /f /im node.exe 2>nul
echo âœ… Ð’ÑÐµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹
exit /b 0

REM Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÑÐ¸Ð³Ð½Ð°Ð»Ð¾Ð²
set "cleanup_cmd=call :cleanup"

REM ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð»Ð¸ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
echo ðŸ“¦ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹...

if not exist "server\node_modules" (
    echo ðŸ“¥ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ ÑÐµÑ€Ð²ÐµÑ€Ð°...
    cd server
    call npm install
    cd ..
)

if not exist "client\node_modules" (
    echo ðŸ“¥ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°...
    cd client
    call npm install
    cd ..
)

echo âœ… Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ñ‹

REM Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÑÐµÑ€Ð²ÐµÑ€
echo ðŸ”„ Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð° API...
cd server
start "SofanyCRM Server" cmd /k "npm run dev"
cd ..

REM Ð–Ð´ÐµÐ¼ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð»ÑÑ
echo â³ ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð°...
timeout /t 5 /nobreak >nul

REM Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÐºÐ»Ð¸ÐµÐ½Ñ‚
echo ðŸ”„ Ð—Ð°Ð¿ÑƒÑÐº ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°...
cd client
start "SofanyCRM Client" cmd /k "npm start"
cd ..

REM Ð–Ð´ÐµÐ¼ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ð»ÑÑ
echo â³ ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°...
timeout /t 10 /nobreak >nul

echo.
echo ðŸŽ‰ Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð°!
echo ================================
echo ðŸŒ ÐšÐ»Ð¸ÐµÐ½Ñ‚: http://localhost:3000
echo ðŸ”§ Ð¡ÐµÑ€Ð²ÐµÑ€: http://localhost:5000
echo ðŸ“‹ Ð—Ð°ÐºÐ°Ð·Ñ‹: http://localhost:3000/orders
echo ðŸ­ ÐšÐ°Ð½Ð±Ð°Ð½: http://localhost:3000/kanban
echo âš™ï¸ ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾: http://localhost:3000/production
echo.
echo ðŸ“ Ð”Ð»Ñ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð·Ð°ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð¾ÐºÐ½Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´
echo ================================

REM ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€
echo ðŸŒ ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€...
timeout /t 2 /nobreak >nul
start http://localhost:3000

echo.
echo ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð»ÑŽÐ±ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ Ð´Ð»Ñ Ð²Ñ‹Ñ…Ð¾Ð´Ð°...
pause >nul
